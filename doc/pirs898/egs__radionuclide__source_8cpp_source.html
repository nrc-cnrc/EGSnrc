<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>EGSnrc C++ class library: /home/rwtownson/EGSnrc/HEN_HOUSE/egs++/sources/egs_radionuclide_source/egs_radionuclide_source.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<script language="JavaScript" type="text/javascript">
    $(document).ready(function(){
    var imgArr = new Array( // relative paths of images
    'linac2.png',
    'egs_isotropic_source.png',
    'egs_conestack.png',
    'car.png',
    'egs_cd_geometry.png',
    'chamber.png',
    'c_in_box.png',
    'egs_collimated_source.png',
    'egs_iplanes.png',
    'egs_point_source.png',
    'linac_s1.png',
    'egs_ndgeometry.png',
    'egs_roundrect_cylinders.png',
    'egs_source_collection.png',
    'egs_xyzrepeater.png',
    'cones.png',
    'egs_prism.png',
    'egs_pyramid.png',
    'I6702.png',
    'egs_xyzgeometry.png',
    'linac1.png'
    );
    var preloadArr = new Array();
    var i;
    /* preload images */
    for(i=0; i < imgArr.length; i++){
    preloadArr[i] = new Image();
    preloadArr[i].src = imgArr[i];
    }
    changeImg();
    var intID = setInterval(changeImg, 5000);
    /* image rotator */
    function changeImg(){
    $('#egsImageScroller').css('background','#000000 url(' + preloadArr[Math.floor(Math.random() * imgArr.length)].src +') center/contain no-repeat');
    }
    });
</script>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="egsImageScroller"></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EGSnrc C++ class library
   &#160;<span id="projectnumber">Report PIRS-898 (2021)</span>
   </div>
   <div id="projectbrief">Iwan Kawrakow, Ernesto Mainegra-Hing, Frederic Tessier, Reid Townson and Blake Walters</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_eb4d01531b9ed501760fe6ab159423ee.html">egs++</a></li><li class="navelem"><a class="el" href="dir_4459bd7330e87a7933683e82447c8844.html">sources</a></li><li class="navelem"><a class="el" href="dir_b55ce4bbfc6a762c8c2e9c6fc5db628b.html">egs_radionuclide_source</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">egs_radionuclide_source.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="egs__radionuclide__source_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">###############################################################################</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">#  EGSnrc egs++ radionuclide source</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">#  Copyright (C) 2015 National Research Council Canada</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">#  This file is part of EGSnrc.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">#  EGSnrc is free software: you can redistribute it and/or modify it under</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">#  the terms of the GNU Affero General Public License as published by the</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">#  Free Software Foundation, either version 3 of the License, or (at your</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">#  option) any later version.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">#  EGSnrc is distributed in the hope that it will be useful, but WITHOUT ANY</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">#  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">#  FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">#  more details.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">#  You should have received a copy of the GNU Affero General Public License</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">#  along with EGSnrc. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">###############################################################################</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">#  Author:          Reid Townson, 2016</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">#  Contributors:    Martin Martinov</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">#                   Ernesto Mainegra-Hing</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">###############################################################################</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__radionuclide__source_8h.html">egs_radionuclide_source.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__input_8h.html">egs_input.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__math_8h.html">egs_math.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__application_8h.html">egs_application.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSource.html#a3160cc69b4e0aa26300ba862e39e0c71">   43</a></span>&#160;<a class="code" href="classEGS__RadionuclideSource.html#a3160cc69b4e0aa26300ba862e39e0c71">EGS_RadionuclideSource::EGS_RadionuclideSource</a>(<a class="code" href="classEGS__Input.html">EGS_Input</a> *input,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="classEGS__ObjectFactory.html">EGS_ObjectFactory</a> *f) : <a class="code" href="classEGS__BaseSource.html">EGS_BaseSource</a>(input,f),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    baseSource(0), q_allowed(0), decays(0), activity(1), sCount(0) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    vector&lt;int&gt; tmp_q;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    err = input-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;charge&quot;</span>, tmp_q);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span> (std::find(q_allowed.begin(), q_allowed.end(), -1) != q_allowed.end()</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                &amp;&amp; std::find(q_allowed.begin(), q_allowed.end(), 0) != q_allowed.end()</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                &amp;&amp; std::find(q_allowed.begin(), q_allowed.end(), 1) != q_allowed.end()</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                &amp;&amp; std::find(q_allowed.begin(), q_allowed.end(), 2) != q_allowed.end()</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;           ) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            q_allowAll = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            q_allowAll = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        q_allowed = tmp_q;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        q_allowAll = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        q_allowed.push_back(-1);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        q_allowed.push_back(1);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        q_allowed.push_back(0);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        q_allowed.push_back(2);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// Create the decay spectra</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    count = 0;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    sCount = 0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    Emax = 0;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    EGS_Float spectrumWeightTotal = 0;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    disintegrationOccurred = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    ishower = -1;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    time = 0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    lastDisintTime = 0;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">while</span> (input-&gt;<a class="code" href="classEGS__Input.html#abbc7318fada72f9ab9debe48019195a3">getInputItem</a>(<span class="stringliteral">&quot;spectrum&quot;</span>)) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;**********************************************\n&quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        decays.push_back(createSpectrum(input));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="comment">// If spectrum creation failed skip to the next spectrum block</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">// We check the getShowerIndex function to ensure this cast to a</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">// radionuclide spectrum succeeded. Other spectra will fail!</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">if</span> (!decays[i] || decays[i]-&gt;<a class="code" href="classEGS__RadionuclideSource.html#aeef62b7f4ed3d7c36e3ee33b68b18c0a">getShowerIndex</a>() != -1) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            decays.pop_back();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        EGS_Float spectrumMaxE = decays[i]-&gt;maxEnergy();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span> (spectrumMaxE &gt; Emax) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            Emax = spectrumMaxE;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        spectrumWeightTotal += decays[i]-&gt;getSpectrumWeight();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        ++i;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (decays.size() &lt; 1) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;\nEGS_RadionuclideSource: Error: No spectrum of type EGS_RadionuclideSpectrum was defined.\n&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// Normalize the spectrum weights</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;decays.size(); ++i) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        decays[i]-&gt;setSpectrumWeight(</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            decays[i]-&gt;getSpectrumWeight() / spectrumWeightTotal);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            decays[i]-&gt;setSpectrumWeight(</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                decays[i]-&gt;getSpectrumWeight() +</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                decays[i-1]-&gt;getSpectrumWeight());</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// Get the activity</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    EGS_Float tmp_A;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    err = input-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;activity&quot;</span>, tmp_A);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        activity = tmp_A;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        activity = 1;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource: Activity [disintegrations/s]: %e\n&quot;</span>,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                   activity);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Get the experiment time</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// This puts a limit on emission times - particles beyond the</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// limit are discarded</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    err = input-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;experiment time&quot;</span>, experimentTime);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        experimentTime = 0.;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (experimentTime &gt; 0.) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource: Experiment time [s]: %e\n&quot;</span>,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                       experimentTime);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource: Experiment time will not limit the simulation.\n&quot;</span>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Get the active application</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    app = <a class="code" href="classEGS__Application.html#a0bacaf36aa14a5851c5dd6f8efd679ee">EGS_Application::activeApplication</a>();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// Check for deprecated inputs</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">string</span> dummy;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    err = input-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;source type&quot;</span>,dummy);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">int</span> err2 = input-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;geometry&quot;</span>,dummy);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (!err || !err2) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;\nEGS_RadionuclideSource: Warning: Inputs for defining the radionuclide source as an isotropic or collimated source (e.g. &#39;source type&#39;) are deprecated. Please see the documentation - define the type of source separately and then refer to it using the new &#39;base source&#39; input.\n&quot;</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// Import base source</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    err = input-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;base source&quot;</span>,sName);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;\nEGS_RadionuclideSource: Error: Base source must be defined\n&quot;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                 <span class="stringliteral">&quot;using &#39;base source = some_name&#39;\n&quot;</span>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    baseSource = <a class="code" href="classEGS__BaseSource.html#a60af23bf71e2400be75ad81de607a8b0">EGS_BaseSource::getSource</a>(sName);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (!baseSource) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;\nEGS_RadionuclideSource: Error: no source named %s&quot;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                 <span class="stringliteral">&quot; is defined\n&quot;</span>,sName.c_str());</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// Initialize emission type to signify nothing has happened yet</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    emissionType = 99;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// Finish</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    setUp();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> spec_msg1[] = <span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum:&quot;</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<a class="code" href="classEGS__RadionuclideSpectrum.html">EGS_RadionuclideSpectrum</a> *EGS_RadionuclideSource::createSpectrum(<a class="code" href="classEGS__Input.html">EGS_Input</a> *input) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Read inputs for the spectrum</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (!input) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s got null input?\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="classEGS__Input.html">EGS_Input</a> *inp = input;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">bool</span> delete_it = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span> (!input-&gt;<a class="code" href="classEGS__Input.html#aad9de26bdcc267f053abd955cf2f02b4">isA</a>(<span class="stringliteral">&quot;spectrum&quot;</span>)) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        inp = input-&gt;<a class="code" href="classEGS__Input.html#a1fb7e11391a1ab33c23321633d035781">takeInputItem</a>(<span class="stringliteral">&quot;spectrum&quot;</span>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (!inp) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s no &#39;spectrum&#39; input!\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        delete_it = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Initializing radionuclide spectrum...\n&quot;</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">string</span> nuclide;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">int</span> err = inp-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;nuclide&quot;</span>,nuclide);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;isotope&quot;</span>,nuclide);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            err = inp-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;radionuclide&quot;</span>,nuclide);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;nuclide&#39; input\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    EGS_Float relativeActivity;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    err = inp-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;relative activity&quot;</span>,relativeActivity);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        relativeActivity = 1;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// Determine whether to sample X-Rays and Auger electrons</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// using the ensdf data (options: eadl, ensdf or none)</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">string</span> tmp_relaxType, relaxType;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    err = inp-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;atomic relaxations&quot;</span>, tmp_relaxType);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        relaxType = tmp_relaxType;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        relaxType = <span class="stringliteral">&quot;eadl&quot;</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;ensdf&quot;</span>)) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        relaxType = <span class="stringliteral">&quot;ensdf&quot;</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Fluorescence and auger from the ensdf file will be used.\n&quot;</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;eadl&quot;</span>)) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        relaxType = <span class="stringliteral">&quot;eadl&quot;</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Fluorescence and auger from the ensdf file will be ignored. EADL relaxations will be used.\n&quot;</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;none&quot;</span>) || inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;off&quot;</span>) || inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;no&quot;</span>)) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        relaxType = <span class="stringliteral">&quot;off&quot;</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Fluorescence and auger from the ensdf file will be ignored. No relaxations following radionuclide disintegrations will be modelled.\n&quot;</span>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Error: Invalid selection for &#39;atomic relaxations&#39;. Use &#39;eadl&#39; (default), &#39;ensdf&#39; or &#39;off&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// Determine whether to output beta energy spectra to files</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// (options: yes or no)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">string</span> tmp_outputBetaSpectra, outputBetaSpectra;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    err = inp-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;output beta spectra&quot;</span>, tmp_outputBetaSpectra);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        outputBetaSpectra = tmp_outputBetaSpectra;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(outputBetaSpectra,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Beta energy spectra will be output to files.\n&quot;</span>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(outputBetaSpectra,<span class="stringliteral">&quot;no&quot;</span>)) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Beta energy spectra will not be output to files.\n&quot;</span>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Error: Invalid selection for &#39;output beta spectra&#39;. Use &#39;no&#39; (default) or &#39;yes&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        outputBetaSpectra = <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// Determine whether to score alpha energy locally or discard it</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// By default, the energy is discarded</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">string</span> tmp_alphaScoring;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordtype">bool</span> scoreAlphasLocally = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    err = inp-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;alpha scoring&quot;</span>, tmp_alphaScoring);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(tmp_alphaScoring,<span class="stringliteral">&quot;local&quot;</span>)) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            scoreAlphasLocally = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Alpha particles will deposit energy locally, in the same region as creation.\n&quot;</span>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(tmp_alphaScoring,<span class="stringliteral">&quot;discard&quot;</span>)) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            scoreAlphasLocally = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Alpha particles will be discarded (no transport or energy deposition).\n&quot;</span>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Error: Invalid selection for &#39;alpha scoring&#39;. Use &#39;discard&#39; (default) or &#39;local&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Determine whether to score alpha energy locally or discard it</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// By default, the energy is discarded</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">string</span> tmp_allowMultiTransition;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">bool</span> allowMultiTransition = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    err = inp-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;extra transition approximation&quot;</span>, tmp_allowMultiTransition);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(tmp_allowMultiTransition,<span class="stringliteral">&quot;on&quot;</span>)) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            allowMultiTransition = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Extra transition approximation is on. If the intensity away from a level in a radionuclide daughter is larger than the intensity feeding the level (e.g. decays to that level), then additional transitions away from that level will be sampled. They will not be correlated with decays, but the spectrum will produce emission rates to match both the decay intensities and the internal transition intensities from the ensdf file.\n&quot;</span>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(tmp_allowMultiTransition,<span class="stringliteral">&quot;off&quot;</span>)) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            allowMultiTransition = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Extra transition approximation is off.\n&quot;</span>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: Error: Invalid selection for &#39;extra transition approximation&#39;. Use &#39;off&#39; (default) or &#39;on&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// For ensdf input, first check for the input argument</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">string</span> ensdf_file;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    err = inp-&gt;<a class="code" href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">getInput</a>(<span class="stringliteral">&quot;ensdf file&quot;</span>,ensdf_file);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// If not passed as input, find the ensdf file in the</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// directory $HEN_HOUSE/spectra/lnhb/ensdf/</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="classEGS__Application.html">EGS_Application</a> *app = <a class="code" href="classEGS__Application.html#a0bacaf36aa14a5851c5dd6f8efd679ee">EGS_Application::activeApplication</a>();</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">if</span> (app) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(app-&gt;<a class="code" href="classEGS__Application.html#ae9dd44d1bbd4fb613c1265369c54bd87">getHenHouse</a>(),<span class="stringliteral">&quot;spectra&quot;</span>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),<span class="stringliteral">&quot;lnhb&quot;</span>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),<span class="stringliteral">&quot;ensdf&quot;</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordtype">char</span> *hen_house = getenv(<span class="stringliteral">&quot;HEN_HOUSE&quot;</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">if</span> (!hen_house) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: &quot;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                           <span class="stringliteral">&quot;No active application and HEN_HOUSE not defined.\n&quot;</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                           <span class="stringliteral">&quot;Assuming local directory for spectra\n&quot;</span>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                ensdf_file = <span class="stringliteral">&quot;./&quot;</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(hen_house,<span class="stringliteral">&quot;spectra&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),<span class="stringliteral">&quot;lnhb&quot;</span>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),<span class="stringliteral">&quot;ensdf&quot;</span>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),nuclide.append(<span class="stringliteral">&quot;.txt&quot;</span>));</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// Check that the ensdf file exists</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    ifstream ensdf_fh;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    ensdf_fh.open(ensdf_file.c_str(),ios::in);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (!ensdf_fh.is_open()) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;EGS_RadionuclideSource::createSpectrum: failed to open ensdf file %s&quot;</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                   <span class="stringliteral">&quot; for reading\n&quot;</span>,ensdf_file.c_str());</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    ensdf_fh.close();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// Create the spectrum</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="classEGS__RadionuclideSpectrum.html">EGS_RadionuclideSpectrum</a> *spec = <span class="keyword">new</span> <a class="code" href="classEGS__RadionuclideSpectrum.html">EGS_RadionuclideSpectrum</a>(nuclide, ensdf_file, relativeActivity, relaxType, outputBetaSpectra, scoreAlphasLocally, allowMultiTransition);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">return</span> spec;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSource.html#acaabdeabd6ce8351aaa829bf93375b5a">  353</a></span>&#160;EGS_I64 <a class="code" href="classEGS__RadionuclideSource.html#acaabdeabd6ce8351aaa829bf93375b5a">EGS_RadionuclideSource::getNextParticle</a>(<a class="code" href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a> *rndm, <span class="keywordtype">int</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        &amp;q, <span class="keywordtype">int</span> &amp;latch, EGS_Float &amp;E, EGS_Float &amp;wt, <a class="code" href="classEGS__Vector.html">EGS_Vector</a> &amp;x, <a class="code" href="classEGS__Vector.html">EGS_Vector</a></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        &amp;u) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (decays.size() &gt; 1 &amp;&amp; disintegrationOccurred) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">// Sample a uniform random number</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        EGS_Float uRand = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">// Sample which spectrum to use</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">for</span> (i=0; i&lt;decays.size(); ++i) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">if</span> (uRand &lt; decays[i]-&gt;getSpectrumWeight()) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// Check if the emission time is within the experiment time limit</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> (experimentTime &lt;= 0. || time &lt; experimentTime) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">// Keep this particle</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="comment">// If the particle was emitted outside the</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">// experiment time window, just set the energy to zero to discard</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        E = 0;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">return</span> ishower+1;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    EGS_I64 ishowerOld = decays[i]-&gt;getShowerIndex();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    E = decays[i]-&gt;sample(rndm);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    EGS_I64 ishowerNew = decays[i]-&gt;getShowerIndex();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> (ishowerNew &gt; ishowerOld) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        disintegrationOccurred = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        time = lastDisintTime + -log(1.-rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>()) / activity * (ishowerNew - ishowerOld);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        lastDisintTime = time;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        ishower += (ishowerNew - ishowerOld);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        disintegrationOccurred = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// The time returned from the spectrum is just the time</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="comment">// since the last disintegration event, so this is only</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment">// non-zero for internal transitions. This is why the</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">// times are added here - each transition occurs only after</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment">// the delay of the previous.</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        time += decays[i]-&gt;getTime();</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    q = decays[i]-&gt;getCharge();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">int</span> qTemp(q), latchTemp(latch);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    EGS_Float ETemp(E);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    baseSource-&gt;<a class="code" href="classEGS__BaseSource.html#aac271bf033f41e63d83683f8faba9f01">getNextParticle</a>(rndm, qTemp, latchTemp, ETemp, wt, x, u);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    sCount++;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    latch = 0;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> (disintegrationOccurred) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        xOfDisintegration = x;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        x = xOfDisintegration;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// Now that we have the position of the particle, we can</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// find the region and deposit any sub-threshold contributions locally</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// This includes edep from relaxations, and alpha particle energy</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    EGS_Float edep = decays[i]-&gt;getEdep();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (edep &gt; 0) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        app-&gt;setEdep(edep);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordtype">int</span> ireg = app-&gt;isWhere(x);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        app-&gt;<a class="code" href="classEGS__Application.html#ab0bb74cea79054d6fa7aab2125e6ca4e">userScoring</a>(3, ireg);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// Check if the charge is allowed</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (q_allowAll || std::find(q_allowed.begin(), q_allowed.end(), q) != q_allowed.end()) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">// Keep the particle</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// Don&#39;t transport the particle</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        E = 0;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">// If the energy is zero, also set the weight to zero</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">// If you don&#39;t do this, electrons will still be given their rest</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// mass energy in shower()</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (E &lt; <a class="code" href="group__egspp__main.html#gac5a51c4d1a2d49ad111b65c848f45719">epsilon</a>) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        wt = 0;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> ishower+1;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keywordtype">void</span> EGS_RadionuclideSource::setUp() {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="classEGS__Object.html#a84f3f4988afbd9ea3eea30659d617d40">otype</a> = <span class="stringliteral">&quot;EGS_RadionuclideSource&quot;</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classEGS__RadionuclideSource.html#a754bafa80e359c5d1ce5fac064378076">isValid</a>()) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> = <span class="stringliteral">&quot;Invalid radionuclide source&quot;</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> = <span class="stringliteral">&quot;Radionuclide production in base source &quot;</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> += sName;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> += <span class="stringliteral">&quot; with:&quot;</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">if</span> (std::find(q_allowed.begin(), q_allowed.end(), -1) !=</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                q_allowed.end()) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> += <span class="stringliteral">&quot; electrons&quot;</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">if</span> (std::find(q_allowed.begin(), q_allowed.end(), 0) != q_allowed.end()) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> += <span class="stringliteral">&quot; photons&quot;</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">if</span> (std::find(q_allowed.begin(), q_allowed.end(), 1) != q_allowed.end()) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> += <span class="stringliteral">&quot; positrons&quot;</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">if</span> (std::find(q_allowed.begin(), q_allowed.end(), 1) != q_allowed.end()) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> += <span class="stringliteral">&quot; alphas&quot;</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> += <span class="stringliteral">&quot;\nBase source description:\n&quot;</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">description</a> += baseSource-&gt;<a class="code" href="classEGS__BaseSource.html#a2cd84ec353649285ae14741bb8986be8">getSourceDescription</a>();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSource.html#a9478cb75041a864d3caec186701ce5bc">  475</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classEGS__RadionuclideSource.html#a9478cb75041a864d3caec186701ce5bc">EGS_RadionuclideSource::storeState</a>(ostream &amp;data_out)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;decays.size(); ++i) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">if</span> (!decays[i]-&gt;<a class="code" href="classEGS__RadionuclideSource.html#a9478cb75041a864d3caec186701ce5bc">storeState</a>(data_out)) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="group__egspp__main.html#ga02ff22ad01a5d7f52db6fea9c4615286">egsStoreI64</a>(data_out,count);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="group__egspp__main.html#ga02ff22ad01a5d7f52db6fea9c4615286">egsStoreI64</a>(data_out,sCount);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    baseSource-&gt;<a class="code" href="classEGS__BaseSource.html#af861f6c0aafcc3d649ee08940763c0dd">storeState</a>(data_out);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSource.html#add096eb2057b5179126e28f8828c60f3">  488</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classEGS__RadionuclideSource.html#add096eb2057b5179126e28f8828c60f3">EGS_RadionuclideSource::addState</a>(istream &amp;data) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;decays.size(); ++i) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">if</span> (!decays[i]-&gt;<a class="code" href="classEGS__RadionuclideSource.html#a4d92f40a9ad76e251f79208b2a279959">setState</a>(data)) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        ishower += decays[i]-&gt;getShowerIndex();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    EGS_I64 tmp_val;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="group__egspp__main.html#ga70ad7f086f097e38f94a573f49a4dd1f">egsGetI64</a>(data,tmp_val);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    count += tmp_val;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="group__egspp__main.html#ga70ad7f086f097e38f94a573f49a4dd1f">egsGetI64</a>(data,tmp_val);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    sCount += tmp_val;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    baseSource-&gt;<a class="code" href="classEGS__BaseSource.html#a152a7d50ae853fd0fd18c8895e5c516f">addState</a>(data);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSource.html#aaa1e01a67e3585e6156e9316c3dcb6fd">  505</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEGS__RadionuclideSource.html#aaa1e01a67e3585e6156e9316c3dcb6fd">EGS_RadionuclideSource::resetCounter</a>() {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;decays.size(); ++i) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        decays[i]-&gt;resetCounter();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    ishower = 0;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    count = 0;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    sCount = 0;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    baseSource-&gt;<a class="code" href="classEGS__BaseSource.html#a82dc0b0f2f506ff9d15a6b3d4c3127b3">resetCounter</a>();</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSource.html#a4d92f40a9ad76e251f79208b2a279959">  515</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classEGS__RadionuclideSource.html#a4d92f40a9ad76e251f79208b2a279959">EGS_RadionuclideSource::setState</a>(istream &amp;data) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;decays.size(); ++i) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">if</span> (!decays[i]-&gt;<a class="code" href="classEGS__RadionuclideSource.html#a4d92f40a9ad76e251f79208b2a279959">setState</a>(data)) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="group__egspp__main.html#ga70ad7f086f097e38f94a573f49a4dd1f">egsGetI64</a>(data,count);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <a class="code" href="group__egspp__main.html#ga70ad7f086f097e38f94a573f49a4dd1f">egsGetI64</a>(data,sCount);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    baseSource-&gt;<a class="code" href="classEGS__BaseSource.html#ad2ff6a20ae831eef48b8efb8b9bd202d">setState</a>(data);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    EGS_RADIONUCLIDE_SOURCE_EXPORT <a class="code" href="classEGS__BaseSource.html">EGS_BaseSource</a> *createSource(<a class="code" href="classEGS__Input.html">EGS_Input</a></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            *input, <a class="code" href="classEGS__ObjectFactory.html">EGS_ObjectFactory</a> *f) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            createSourceTemplate&lt;EGS_RadionuclideSource&gt;(input,f,<span class="stringliteral">&quot;radionuclide &quot;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    <span class="stringliteral">&quot;source&quot;</span>);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#a6c358434a6c7aa0e94d1cf6707dc85af">  539</a></span>&#160;<a class="code" href="classEGS__RadionuclideSpectrum.html#a6c358434a6c7aa0e94d1cf6707dc85af">EGS_RadionuclideSpectrum::EGS_RadionuclideSpectrum</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> nuclide, <span class="keyword">const</span> <span class="keywordtype">string</span> ensdf_file,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keyword">const</span> EGS_Float relativeActivity, <span class="keyword">const</span> <span class="keywordtype">string</span> relaxType, <span class="keyword">const</span> <span class="keywordtype">string</span> outputBetaSpectra, <span class="keyword">const</span> <span class="keywordtype">bool</span> scoreAlphasLocally, <span class="keyword">const</span> <span class="keywordtype">bool</span> allowMultiTransition) {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// For now, hard-code verbose mode</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// 0 - minimal output</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// 1 - some output of ensdf data and normalized intensities</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// 2 - verbose output</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">int</span> verbose = 0;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// Read in the data file for the nuclide</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// and build the decay structure</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    decays = <span class="keyword">new</span> <a class="code" href="classEGS__Ensdf.html">EGS_Ensdf</a>(nuclide, ensdf_file, relaxType, allowMultiTransition, verbose);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// Normalize the emission and transition intensities</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    decays-&gt;normalizeIntensities();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// Get the beta energy spectra</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    betaSpectra = <span class="keyword">new</span> <a class="code" href="classEGS__RadionuclideBetaSpectrum.html">EGS_RadionuclideBetaSpectrum</a>(decays, outputBetaSpectra);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// Get the particle records from the decay scheme</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    myBetas = decays-&gt;getBetaRecords();</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    myAlphas = decays-&gt;getAlphaRecords();</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    myGammas = decays-&gt;getGammaRecords();</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    myMetastableGammas = decays-&gt;getMetastableGammaRecords();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    myUncorrelatedGammas = decays-&gt;getUncorrelatedGammaRecords();</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    myLevels = decays-&gt;getLevelRecords();</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    xrayIntensities = decays-&gt;getXRayIntensities();</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    xrayEnergies = decays-&gt;getXRayEnergies();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    augerIntensities = decays-&gt;getAugerIntensities();</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    augerEnergies = decays-&gt;getAugerEnergies();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// Initialization</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    currentLevel = 0;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    Emax = 0;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    currentTime = 0;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    ishower = -1; <span class="comment">// Start with ishower -1 so first shower has index 0</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    totalGammaEnergy = 0;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    relaxationType = relaxType;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    scoreAlphasLocal = scoreAlphasLocally;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// Get the maximum energy for emissions</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">for</span> (vector&lt;BetaRecordLeaf *&gt;::iterator beta = myBetas.begin();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            beta != myBetas.end(); beta++) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordtype">double</span> energy = (*beta)-&gt;getFinalEnergy();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">if</span> (Emax &lt; energy) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            Emax = energy;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">for</span> (vector&lt;AlphaRecord *&gt;::iterator alpha = myAlphas.begin();</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            alpha != myAlphas.end(); alpha++) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordtype">double</span> energy = (*alpha)-&gt;getFinalEnergy();</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">if</span> (Emax &lt; energy) {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            Emax = energy;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myGammas.begin();</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            gamma != myGammas.end(); gamma++) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordtype">double</span> energy = (*gamma)-&gt;getDecayEnergy();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">if</span> (Emax &lt; energy) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            Emax = energy;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myUncorrelatedGammas.begin();</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            gamma != myUncorrelatedGammas.end(); gamma++) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordtype">double</span> energy = (*gamma)-&gt;getDecayEnergy();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">if</span> (Emax &lt; energy) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            Emax = energy;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; xrayEnergies.size(); ++i) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        numSampledXRay.push_back(0);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (Emax &lt; xrayEnergies[i]) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            Emax = xrayEnergies[i];</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; augerEnergies.size(); ++i) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        numSampledAuger.push_back(0);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">if</span> (Emax &lt; augerEnergies[i]) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            Emax = augerEnergies[i];</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">// Set the weight of the spectrum</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    spectrumWeight = relativeActivity;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSpectrum: Emax: %f\n&quot;</span>,Emax);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSpectrum: Relative activity: %f\n&quot;</span>,relativeActivity);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">// Set the application</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    app = <a class="code" href="classEGS__Application.html#a0bacaf36aa14a5851c5dd6f8efd679ee">EGS_Application::activeApplication</a>();</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;};</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#a4bc1f56cb628f18a6c9af794a7649d26">  638</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEGS__RadionuclideSpectrum.html#a4bc1f56cb628f18a6c9af794a7649d26">EGS_RadionuclideSpectrum::printSampledEmissions</a>() {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;\nSampled %s emissions:\n&quot;</span>, decays-&gt;radionuclide.c_str());</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;========================\n&quot;</span>);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">if</span> (ishower &lt; 1) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;EGS_RadionuclideSpectrum::printSampledEmissions: Warning: The number of disintegrations (tracked by `ishower`) is less than 1.\n&quot;</span>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Energy | Intensity per 100 decays (adjusted by %f)\n&quot;</span>, decays-&gt;decayDiscrepancy);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> (myBetas.size() &gt; 0) {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Beta records:\n&quot;</span>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">for</span> (vector&lt;BetaRecordLeaf *&gt;::iterator beta = myBetas.begin();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            beta != myBetas.end(); beta++) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f\n&quot;</span>, (*beta)-&gt;getFinalEnergy(),</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                       ((EGS_Float)(*beta)-&gt;getNumSampled()/(ishower+1))*100);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> (myAlphas.size() &gt; 0) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Alpha records:\n&quot;</span>);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">for</span> (vector&lt;AlphaRecord *&gt;::iterator alpha = myAlphas.begin();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            alpha != myAlphas.end(); alpha++) {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f\n&quot;</span>, (*alpha)-&gt;getFinalEnergy(),</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                       ((EGS_Float)(*alpha)-&gt;getNumSampled()/(ishower+1))*100);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">if</span> (myGammas.size() &gt; 0) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Gamma records (E,Igamma,Ice,Ipp):\n&quot;</span>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    EGS_I64 totalNumSampled = 0;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myGammas.begin();</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            gamma != myGammas.end(); gamma++) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        totalNumSampled += (*gamma)-&gt;getGammaSampled();</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f %.4e %.4e\n&quot;</span>, (*gamma)-&gt;getDecayEnergy(),</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                       ((EGS_Float)(*gamma)-&gt;getGammaSampled()/(ishower+1))*100,</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                       ((EGS_Float)(*gamma)-&gt;getICSampled()/(ishower+1))*100,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                       ((EGS_Float)(*gamma)-&gt;getIPSampled()/(ishower+1))*100</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                      );</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span> (myGammas.size() &gt; 0) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">if</span> (totalNumSampled &gt; 0) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Average gamma energy: %f\n&quot;</span>,</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                           totalGammaEnergy / totalNumSampled);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Zero gamma transitions occurred.\n&quot;</span>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">if</span> (myUncorrelatedGammas.size() &gt; 0) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Uncorrelated gamma records (E,Igamma,Ice,Ipp):\n&quot;</span>);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myUncorrelatedGammas.begin();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            gamma != myUncorrelatedGammas.end(); gamma++) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f %.4e %.4e\n&quot;</span>, (*gamma)-&gt;getDecayEnergy(),</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                       ((EGS_Float)(*gamma)-&gt;getGammaSampled()/(ishower+1))*100,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                       ((EGS_Float)(*gamma)-&gt;getICSampled()/(ishower+1))*100,</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                       ((EGS_Float)(*gamma)-&gt;getIPSampled()/(ishower+1))*100</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                      );</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">if</span> (xrayEnergies.size() &gt; 0) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;X-Ray records:\n&quot;</span>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; xrayEnergies.size(); ++i) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f\n&quot;</span>, xrayEnergies[i],</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                       ((EGS_Float)numSampledXRay[i]/(ishower+1))*100);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">if</span> (augerEnergies.size() &gt; 0) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Auger records:\n&quot;</span>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; augerEnergies.size(); ++i) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f\n&quot;</span>, augerEnergies[i],</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                       ((EGS_Float)numSampledAuger[i]/(ishower+1))*100);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#abb64c6df6ae518d3a7cf75166f2ed94c">  720</a></span>&#160;EGS_Float <a class="code" href="classEGS__RadionuclideSpectrum.html#abb64c6df6ae518d3a7cf75166f2ed94c">EGS_RadionuclideSpectrum::sample</a>(<a class="code" href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a> *rndm) {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">// The energy of the sampled particle</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    EGS_Float E;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">// Local energy depositions</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    edep = 0;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="comment">// Time delay of this particle</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    currentTime = 0;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">// The type of emission particle</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    emissionType = 0;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// Check for relaxation particles due to shell vacancies in the daughter</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">// These are created from internal transitions or electron capture</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">if</span> (relaxParticles.size() &gt; 0) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="comment">// Get the energy and charge of the last particle on the list</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <a class="code" href="structEGS__RelaxationParticle.html">EGS_RelaxationParticle</a> p = relaxParticles.pop();</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        E = p.<a class="code" href="structEGS__RelaxationParticle.html#a9db6f3ddb4a3dbf06fa5e513fd274f8c">E</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        currentQ = p.<a class="code" href="structEGS__RelaxationParticle.html#a4e52533007f3370bc9ecf20701f296d1">q</a>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        emissionType = 1;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">// Sample a uniform random number</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    EGS_Float u = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">// If the daughter is in an excited state</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// check for transitions</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> (currentLevel &amp;&amp; currentLevel-&gt;levelCanDecay() &amp;&amp; currentLevel-&gt;getEnergy() &gt; <a class="code" href="group__egspp__main.html#gac5a51c4d1a2d49ad111b65c848f45719">epsilon</a>) {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myGammas.begin();</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                gamma != myGammas.end(); gamma++) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">if</span> ((*gamma)-&gt;getLevelRecord() == currentLevel) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <span class="keywordflow">if</span> (u &lt; (*gamma)-&gt;getTransitionIntensity()) {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                    <span class="comment">// A gamma transition may either be a gamma emission</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    <span class="comment">// or an internal conversion electron</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    EGS_Float u2 = 0;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                    <span class="keywordflow">if</span> ((*gamma)-&gt;getGammaIntensity() &lt; 1) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                        u2 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    <span class="comment">// Sample how long</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    <span class="comment">// it took for this transition to occur</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    <span class="comment">// time = -halflife / ln(2) * log(1-u)</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                    <span class="keywordtype">double</span> hl = currentLevel-&gt;getHalfLife();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                    <span class="keywordflow">if</span> (hl &gt; 0) {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                        currentTime = -hl * log(1.-rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>()) /</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                                      0.693147180559945309417232121458176568075500134360255254120680009493393;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    <span class="comment">// Determine whether multiple gamma transitions occur</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    <span class="keywordflow">if</span> (rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>() &lt; (*gamma)-&gt;getMultiTransitionProb()) {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                        multiTransitions.push_back(currentLevel);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    <span class="comment">// Update the level of the daughter</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    currentLevel = (*gamma)-&gt;getFinalLevel();</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                    <span class="comment">// If a gamma emission occurs</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    <span class="keywordflow">if</span> (u2 &lt; (*gamma)-&gt;getGammaIntensity()) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                        (*gamma)-&gt;incrGammaSampled();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                        currentQ = (*gamma)-&gt;getCharge();</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                        E = (*gamma)-&gt;getDecayEnergy();</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                        totalGammaEnergy += E;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                        emissionType = 2;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                        <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                    }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (u2 &lt; (*gamma)-&gt;getICIntensity()) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                        (*gamma)-&gt;incrICSampled();</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                        currentQ = -1;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                        emissionType = 3;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        <span class="keywordflow">if</span> ((*gamma)-&gt;icIntensity.size()) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                            <span class="comment">// Determine which shell the conversion electron</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                            <span class="comment">// comes from. This will create a shell vacancy</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                            EGS_Float u3 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*gamma)-&gt;icIntensity.size(); ++i) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                <span class="keywordflow">if</span> (u3 &lt; (*gamma)-&gt;icIntensity[i]) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                                    E = (*gamma)-&gt;getDecayEnergy() - (*gamma)-&gt;getBindingEnergy(i);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                                    <span class="comment">//                                     egsInformation(&quot;test %d %f %f %f\n&quot;,i,(*gamma)-&gt;getDecayEnergy(),decays-&gt;getRelaxations()-&gt;getBindingEnergy(decays-&gt;Z,i),E);</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                    <span class="comment">// Add relaxation particles to the source stack</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                    <span class="keywordflow">if</span> (relaxationType == <span class="stringliteral">&quot;eadl&quot;</span>) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                        <span class="comment">// Generate relaxation particles for a</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                        <span class="comment">// shell vacancy i</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                                        (*gamma)-&gt;relax(i,app-&gt;getEcut()-app-&gt;getRM(),app-&gt;getPcut(),rndm,edep,relaxParticles);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                    }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                                    <span class="comment">// Return the conversion electron</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                                    <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                                }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                            }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                        }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                    }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                        (*gamma)-&gt;incrIPSampled();</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                        emissionType = 13;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                        <span class="comment">// Internal pair production results in a positron</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                        <span class="comment">// and electron pair</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                        <span class="comment">//TODO: This is left for future work, we need to</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                        <span class="comment">// determine the energies of the electron/positron</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                        <span class="comment">// pair (sample uniformly?) and then determine the</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                        <span class="comment">// corresponding directions. It might be best to do</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                        <span class="comment">// this in the source instead of the spectrum.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                        currentQ = 1;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                    }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        currentLevel = 0;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// If we have determined that multiple transitions will occur from some</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="comment">// levels, here we set the current level to an excited state, and return.</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="comment">// The radionuclide source will then sample again using the excited level.</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">if</span> (multiTransitions.size() &gt; 0) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        currentLevel = multiTransitions.back();</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        multiTransitions.pop_back();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// ============================</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">// Sample which decay occurs</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// ============================</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    currentTime = 0;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// Beta-, beta+ and electron capture</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">for</span> (vector&lt;BetaRecordLeaf *&gt;::iterator beta = myBetas.begin();</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            beta != myBetas.end(); beta++) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordflow">if</span> (u &lt; (*beta)-&gt;getBetaIntensity()) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="comment">// Increment the shower number</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            ishower++;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="comment">// Increment the counter of betas and get the charge</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            (*beta)-&gt;incrNumSampled();</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            currentQ = (*beta)-&gt;getCharge();</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="comment">// Set the energy level of the daughter</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            currentLevel = (*beta)-&gt;getLevelRecord();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="comment">// For beta+ records we decide between</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="comment">// branches for beta+ or electron capture</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keywordflow">if</span> (currentQ == 1) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                <span class="comment">// For positron emission, continue as usual</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                <span class="keywordflow">if</span> ((*beta)-&gt;getPositronIntensity() &gt; <a class="code" href="group__egspp__main.html#gac5a51c4d1a2d49ad111b65c848f45719">epsilon</a> &amp;&amp; rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>() &lt; (*beta)-&gt;getPositronIntensity()) {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                    <span class="keywordflow">if</span> (relaxationType == <span class="stringliteral">&quot;eadl&quot;</span> &amp;&amp; (*beta)-&gt;ecShellIntensity.size()) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                        <span class="comment">// Determine which shell the electron capture</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                        <span class="comment">// occurs in. This will create a shell vacancy</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                        EGS_Float u3 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*beta)-&gt;ecShellIntensity.size(); ++i) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                            <span class="keywordflow">if</span> (u3 &lt; (*beta)-&gt;ecShellIntensity[i]) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                <span class="comment">// Generate relaxation particles for a</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                <span class="comment">// shell vacancy i</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                (*beta)-&gt;relax(i,app-&gt;getEcut()-app-&gt;getRM(),app-&gt;getPcut(),rndm,edep,relaxParticles);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                emissionType = 4;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                            }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                        }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    <span class="comment">// For electron capture, there is no emitted particle</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                    <span class="comment">// (only a neutrino)</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    <span class="comment">// so we return a 0 energy particle</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    emissionType = 4;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                emissionType = 5;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                emissionType = 6;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <span class="comment">// Sample the energy from the spectrum alias table</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            E = (*beta)-&gt;getSpectrum()-&gt;sample(rndm);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">// Alphas</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">for</span> (vector&lt;AlphaRecord *&gt;::iterator alpha = myAlphas.begin();</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            alpha != myAlphas.end(); alpha++) {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="keywordflow">if</span> (u &lt; (*alpha)-&gt;getAlphaIntensity()) {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <span class="comment">// Increment the shower number</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            ishower++;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="comment">// Increment the counter of alphas and get the charge</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            (*alpha)-&gt;incrNumSampled();</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            currentQ = (*alpha)-&gt;getCharge();</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            <span class="comment">// Set the energy level of the daughter</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            currentLevel = (*alpha)-&gt;getLevelRecord();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            <span class="comment">// Score alpha energy depositions locally,</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="comment">// because alpha transport is not modeled in EGSnrc.</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="comment">// This is an approximation!</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            <span class="keywordflow">if</span> (scoreAlphasLocal) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                edep += (*alpha)-&gt;getFinalEnergy();</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            emissionType = 7;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <span class="comment">// For alphas we simulate a disintegration but the</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <span class="comment">// transport will not be performed so return 0</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">// Metastable &quot;decays&quot; that will result in internal transitions</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myMetastableGammas.begin();</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            gamma != myMetastableGammas.end(); gamma++) {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="keywordflow">if</span> (u &lt; (*gamma)-&gt;getTransitionIntensity()) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            <span class="comment">// Increment the shower number</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            ishower++;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="comment">// Set the energy level of the daughter as though a</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="comment">// disintegration just occurred</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            currentLevel = (*gamma)-&gt;getLevelRecord();</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            emissionType = 8;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            <span class="comment">// No particle returned</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">// Uncorrelated internal transitions</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myUncorrelatedGammas.begin();</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            gamma != myUncorrelatedGammas.end(); gamma++) {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keywordflow">if</span> (u &lt; (*gamma)-&gt;getTransitionIntensity()) {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="comment">// A gamma transition may either be a gamma emission</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="comment">// or an internal conversion electron</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            EGS_Float u2 = 0;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keywordflow">if</span> ((*gamma)-&gt;getGammaIntensity() &lt; 1) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                u2 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="comment">// If a gamma emission occurs</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keywordflow">if</span> (u2 &lt; (*gamma)-&gt;getGammaIntensity()) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                (*gamma)-&gt;incrGammaSampled();</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                currentQ = (*gamma)-&gt;getCharge();</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                E = (*gamma)-&gt;getDecayEnergy();</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                totalGammaEnergy += E;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                emissionType = 11;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (u2 &lt; (*gamma)-&gt;getICIntensity()) {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                (*gamma)-&gt;incrICSampled();</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                currentQ = -1;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                emissionType = 12;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                <span class="keywordflow">if</span> ((*gamma)-&gt;icIntensity.size()) {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    <span class="comment">// Determine which shell the conversion electron</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    <span class="comment">// comes from. This will create a shell vacancy</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                    EGS_Float u3 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*gamma)-&gt;icIntensity.size(); ++i) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                        <span class="keywordflow">if</span> (u3 &lt; (*gamma)-&gt;icIntensity[i]) {</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                            E = (*gamma)-&gt;getDecayEnergy() - (*gamma)-&gt;getBindingEnergy(i);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                            <span class="comment">// Add relaxation particles to the source stack</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                            <span class="keywordflow">if</span> (relaxationType == <span class="stringliteral">&quot;eadl&quot;</span>) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                <span class="comment">// Generate relaxation particles for a</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                <span class="comment">// shell vacancy i</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                (*gamma)-&gt;relax(i,app-&gt;getEcut()-app-&gt;getRM(),app-&gt;getPcut(),rndm,edep,relaxParticles);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                            }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                            <span class="comment">// Return the conversion electron</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                            <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                        }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                    }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                (*gamma)-&gt;incrIPSampled();</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                emissionType = 14;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                <span class="comment">// Internal pair production results in a positron</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                <span class="comment">// and electron pair</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                <span class="comment">//TODO: This is left for future work, we need to</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="comment">// determine the energies of the electron/positron</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                <span class="comment">// pair (sample uniformly?) and then determine the</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                <span class="comment">// corresponding directions. It might be best to do</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                <span class="comment">// this in the source instead of the spectrum.</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                currentQ = 1;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="comment">// XRays from the ensdf</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; xrayIntensities.size(); ++i) {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordflow">if</span> (u &lt; xrayIntensities[i]) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            numSampledXRay[i]++;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            currentQ = 0;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            E = xrayEnergies[i];</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            emissionType = 9;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">// Auger electrons from the ensdf</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; augerIntensities.size(); ++i) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordflow">if</span> (u &lt; augerIntensities[i]) {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            numSampledAuger[i]++;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            currentQ = -1;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            E = augerEnergies[i];</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            emissionType = 10;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">// If we get here, fission occurs</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="comment">// Count it as a disintegration and return 0</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    ishower++;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;}</div>
<div class="ttc" id="aclassEGS__Application_html"><div class="ttname"><a href="classEGS__Application.html">EGS_Application</a></div><div class="ttdoc">Base class for advanced EGSnrc C++ applications.</div><div class="ttdef"><b>Definition:</b> <a href="egs__application_8h_source.html#l00268">egs_application.h:268</a></div></div>
<div class="ttc" id="aclassEGS__Application_html_a0bacaf36aa14a5851c5dd6f8efd679ee"><div class="ttname"><a href="classEGS__Application.html#a0bacaf36aa14a5851c5dd6f8efd679ee">EGS_Application::activeApplication</a></div><div class="ttdeci">static EGS_Application * activeApplication()</div><div class="ttdoc">Get the active application.</div><div class="ttdef"><b>Definition:</b> <a href="egs__application_8cpp_source.html#l00106">egs_application.cpp:106</a></div></div>
<div class="ttc" id="aclassEGS__Application_html_ab0bb74cea79054d6fa7aab2125e6ca4e"><div class="ttname"><a href="classEGS__Application.html#ab0bb74cea79054d6fa7aab2125e6ca4e">EGS_Application::userScoring</a></div><div class="ttdeci">int userScoring(int iarg, int ir=-1)</div><div class="ttdoc">User scoring function for accumulation of results and VRT implementation.</div><div class="ttdef"><b>Definition:</b> <a href="egs__application_8cpp_source.html#l00114">egs_application.cpp:114</a></div></div>
<div class="ttc" id="aclassEGS__Application_html_ae9dd44d1bbd4fb613c1265369c54bd87"><div class="ttname"><a href="classEGS__Application.html#ae9dd44d1bbd4fb613c1265369c54bd87">EGS_Application::getHenHouse</a></div><div class="ttdeci">const string &amp; getHenHouse() const</div><div class="ttdoc">Returns the HEN_HOUSE directory.</div><div class="ttdef"><b>Definition:</b> <a href="egs__application_8h_source.html#l00495">egs_application.h:495</a></div></div>
<div class="ttc" id="aclassEGS__BaseSource_html"><div class="ttname"><a href="classEGS__BaseSource.html">EGS_BaseSource</a></div><div class="ttdoc">Base source class. All particle sources must be derived from this class.</div><div class="ttdef"><b>Definition:</b> <a href="egs__base__source_8h_source.html#l00084">egs_base_source.h:84</a></div></div>
<div class="ttc" id="aclassEGS__BaseSource_html_a152a7d50ae853fd0fd18c8895e5c516f"><div class="ttname"><a href="classEGS__BaseSource.html#a152a7d50ae853fd0fd18c8895e5c516f">EGS_BaseSource::addState</a></div><div class="ttdeci">virtual bool addState(istream &amp;data_in)</div><div class="ttdoc">Add data from the stream data_in to the source state.</div><div class="ttdef"><b>Definition:</b> <a href="egs__base__source_8h_source.html#l00249">egs_base_source.h:249</a></div></div>
<div class="ttc" id="aclassEGS__BaseSource_html_a2cd84ec353649285ae14741bb8986be8"><div class="ttname"><a href="classEGS__BaseSource.html#a2cd84ec353649285ae14741bb8986be8">EGS_BaseSource::getSourceDescription</a></div><div class="ttdeci">const char * getSourceDescription() const</div><div class="ttdoc">Get a short description of this source.</div><div class="ttdef"><b>Definition:</b> <a href="egs__base__source_8h_source.html#l00111">egs_base_source.h:111</a></div></div>
<div class="ttc" id="aclassEGS__BaseSource_html_a60af23bf71e2400be75ad81de607a8b0"><div class="ttname"><a href="classEGS__BaseSource.html#a60af23bf71e2400be75ad81de607a8b0">EGS_BaseSource::getSource</a></div><div class="ttdeci">static EGS_BaseSource * getSource(const string &amp;Name)</div><div class="ttdoc">Get a pointer to the source named Name.</div><div class="ttdef"><b>Definition:</b> <a href="egs__base__source_8cpp_source.html#l00065">egs_base_source.cpp:65</a></div></div>
<div class="ttc" id="aclassEGS__BaseSource_html_a82dc0b0f2f506ff9d15a6b3d4c3127b3"><div class="ttname"><a href="classEGS__BaseSource.html#a82dc0b0f2f506ff9d15a6b3d4c3127b3">EGS_BaseSource::resetCounter</a></div><div class="ttdeci">virtual void resetCounter()</div><div class="ttdoc">Reset the source state.</div><div class="ttdef"><b>Definition:</b> <a href="egs__base__source_8h_source.html#l00264">egs_base_source.h:264</a></div></div>
<div class="ttc" id="aclassEGS__BaseSource_html_a8cd077c4dc46018211a8be539b33493c"><div class="ttname"><a href="classEGS__BaseSource.html#a8cd077c4dc46018211a8be539b33493c">EGS_BaseSource::description</a></div><div class="ttdeci">string description</div><div class="ttdoc">A short source description.</div><div class="ttdef"><b>Definition:</b> <a href="egs__base__source_8h_source.html#l00368">egs_base_source.h:359</a></div></div>
<div class="ttc" id="aclassEGS__BaseSource_html_aac271bf033f41e63d83683f8faba9f01"><div class="ttname"><a href="classEGS__BaseSource.html#aac271bf033f41e63d83683f8faba9f01">EGS_BaseSource::getNextParticle</a></div><div class="ttdeci">virtual EGS_I64 getNextParticle(EGS_RandomGenerator *rndm, int &amp;q, int &amp;latch, EGS_Float &amp;E, EGS_Float &amp;wt, EGS_Vector &amp;x, EGS_Vector &amp;u)=0</div><div class="ttdoc">Sample the next source particle from the source probability distribution.</div></div>
<div class="ttc" id="aclassEGS__BaseSource_html_ad2ff6a20ae831eef48b8efb8b9bd202d"><div class="ttname"><a href="classEGS__BaseSource.html#ad2ff6a20ae831eef48b8efb8b9bd202d">EGS_BaseSource::setState</a></div><div class="ttdeci">virtual bool setState(istream &amp;data_in)</div><div class="ttdoc">Set the source state based on data from the stream data_in.</div><div class="ttdef"><b>Definition:</b> <a href="egs__base__source_8h_source.html#l00233">egs_base_source.h:233</a></div></div>
<div class="ttc" id="aclassEGS__BaseSource_html_af861f6c0aafcc3d649ee08940763c0dd"><div class="ttname"><a href="classEGS__BaseSource.html#af861f6c0aafcc3d649ee08940763c0dd">EGS_BaseSource::storeState</a></div><div class="ttdeci">virtual bool storeState(ostream &amp;data_out) const</div><div class="ttdoc">Store the source state into the stream data_out.</div><div class="ttdef"><b>Definition:</b> <a href="egs__base__source_8h_source.html#l00219">egs_base_source.h:219</a></div></div>
<div class="ttc" id="aclassEGS__Ensdf_html"><div class="ttname"><a href="classEGS__Ensdf.html">EGS_Ensdf</a></div><div class="ttdoc">The ensdf class for reading ensdf format data files.</div><div class="ttdef"><b>Definition:</b> <a href="egs__ensdf_8h_source.html#l00492">egs_ensdf.h:492</a></div></div>
<div class="ttc" id="aclassEGS__Input_html"><div class="ttname"><a href="classEGS__Input.html">EGS_Input</a></div><div class="ttdoc">A class for storing information in a tree-like structure of key-value pairs. This class is used throu...</div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8h_source.html#l00182">egs_input.h:182</a></div></div>
<div class="ttc" id="aclassEGS__Input_html_a1fb7e11391a1ab33c23321633d035781"><div class="ttname"><a href="classEGS__Input.html#a1fb7e11391a1ab33c23321633d035781">EGS_Input::takeInputItem</a></div><div class="ttdeci">EGS_Input * takeInputItem(const string &amp;key, bool self=true)</div><div class="ttdoc">Get the property named key.</div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8cpp_source.html#l00226">egs_input.cpp:226</a></div></div>
<div class="ttc" id="aclassEGS__Input_html_a9b100c2fe8de2f22befea1e10a46466c"><div class="ttname"><a href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">EGS_Input::compare</a></div><div class="ttdeci">static bool compare(const string &amp;s1, const string &amp;s2)</div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8cpp_source.html#l01170">egs_input.cpp:1170</a></div></div>
<div class="ttc" id="aclassEGS__Input_html_aad9de26bdcc267f053abd955cf2f02b4"><div class="ttname"><a href="classEGS__Input.html#aad9de26bdcc267f053abd955cf2f02b4">EGS_Input::isA</a></div><div class="ttdeci">bool isA(const string &amp;key) const</div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8cpp_source.html#l00278">egs_input.cpp:278</a></div></div>
<div class="ttc" id="aclassEGS__Input_html_abbc7318fada72f9ab9debe48019195a3"><div class="ttname"><a href="classEGS__Input.html#abbc7318fada72f9ab9debe48019195a3">EGS_Input::getInputItem</a></div><div class="ttdeci">EGS_Input * getInputItem(const string &amp;key) const</div><div class="ttdoc">Same as the previous function but now ownership remains with the EGS_Input object.</div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8cpp_source.html#l00245">egs_input.cpp:245</a></div></div>
<div class="ttc" id="aclassEGS__Input_html_af29c673b0d4490891580519862da59f9"><div class="ttname"><a href="classEGS__Input.html#af29c673b0d4490891580519862da59f9">EGS_Input::getInput</a></div><div class="ttdeci">int getInput(const string &amp;key, vector&lt; string &gt; &amp;values) const</div><div class="ttdoc">Assign values to an array of strings from an input identified by key.</div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8cpp_source.html#l00338">egs_input.cpp:338</a></div></div>
<div class="ttc" id="aclassEGS__ObjectFactory_html"><div class="ttname"><a href="classEGS__ObjectFactory.html">EGS_ObjectFactory</a></div><div class="ttdoc">An object factory.</div><div class="ttdef"><b>Definition:</b> <a href="egs__object__factory_8h_source.html#l00206">egs_object_factory.h:206</a></div></div>
<div class="ttc" id="aclassEGS__Object_html_a84f3f4988afbd9ea3eea30659d617d40"><div class="ttname"><a href="classEGS__Object.html#a84f3f4988afbd9ea3eea30659d617d40">EGS_Object::otype</a></div><div class="ttdeci">string otype</div><div class="ttdoc">The object type.</div><div class="ttdef"><b>Definition:</b> <a href="egs__object__factory_8h_source.html#l00180">egs_object_factory.h:180</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideBetaSpectrum_html"><div class="ttname"><a href="classEGS__RadionuclideBetaSpectrum.html">EGS_RadionuclideBetaSpectrum</a></div><div class="ttdoc">Beta spectrum generation for EGS_RadionuclideSpectrum.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8h_source.html#l00084">egs_radionuclide_source.h:84</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSource_html_a3160cc69b4e0aa26300ba862e39e0c71"><div class="ttname"><a href="classEGS__RadionuclideSource.html#a3160cc69b4e0aa26300ba862e39e0c71">EGS_RadionuclideSource::EGS_RadionuclideSource</a></div><div class="ttdeci">EGS_RadionuclideSource(EGS_Input *, EGS_ObjectFactory *f=0)</div><div class="ttdoc">Constructor from input file.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8cpp_source.html#l00043">egs_radionuclide_source.cpp:43</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSource_html_a4d92f40a9ad76e251f79208b2a279959"><div class="ttname"><a href="classEGS__RadionuclideSource.html#a4d92f40a9ad76e251f79208b2a279959">EGS_RadionuclideSource::setState</a></div><div class="ttdeci">bool setState(istream &amp;data)</div><div class="ttdoc">Set the source state according to the data in the stream data.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8cpp_source.html#l00515">egs_radionuclide_source.cpp:515</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSource_html_a754bafa80e359c5d1ce5fac064378076"><div class="ttname"><a href="classEGS__RadionuclideSource.html#a754bafa80e359c5d1ce5fac064378076">EGS_RadionuclideSource::isValid</a></div><div class="ttdeci">bool isValid() const</div><div class="ttdoc">Checks the validity of the source.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8h_source.html#l01056">egs_radionuclide_source.h:1056</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSource_html_a9478cb75041a864d3caec186701ce5bc"><div class="ttname"><a href="classEGS__RadionuclideSource.html#a9478cb75041a864d3caec186701ce5bc">EGS_RadionuclideSource::storeState</a></div><div class="ttdeci">bool storeState(ostream &amp;data_out) const</div><div class="ttdoc">Store the source state to the data stream data_out.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8cpp_source.html#l00475">egs_radionuclide_source.cpp:475</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSource_html_aaa1e01a67e3585e6156e9316c3dcb6fd"><div class="ttname"><a href="classEGS__RadionuclideSource.html#aaa1e01a67e3585e6156e9316c3dcb6fd">EGS_RadionuclideSource::resetCounter</a></div><div class="ttdeci">void resetCounter()</div><div class="ttdoc">Reset the source to a state with zero sampled particles.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8cpp_source.html#l00505">egs_radionuclide_source.cpp:505</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSource_html_acaabdeabd6ce8351aaa829bf93375b5a"><div class="ttname"><a href="classEGS__RadionuclideSource.html#acaabdeabd6ce8351aaa829bf93375b5a">EGS_RadionuclideSource::getNextParticle</a></div><div class="ttdeci">EGS_I64 getNextParticle(EGS_RandomGenerator *rndm, int &amp;q, int &amp;latch, EGS_Float &amp;E, EGS_Float &amp;wt, EGS_Vector &amp;x, EGS_Vector &amp;u)</div><div class="ttdoc">Gets the next particle from the radionuclide spectra.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8cpp_source.html#l00353">egs_radionuclide_source.cpp:353</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSource_html_add096eb2057b5179126e28f8828c60f3"><div class="ttname"><a href="classEGS__RadionuclideSource.html#add096eb2057b5179126e28f8828c60f3">EGS_RadionuclideSource::addState</a></div><div class="ttdeci">bool addState(istream &amp;data)</div><div class="ttdoc">Add the source state from the stream data to the current state.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8cpp_source.html#l00488">egs_radionuclide_source.cpp:488</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSource_html_aeef62b7f4ed3d7c36e3ee33b68b18c0a"><div class="ttname"><a href="classEGS__RadionuclideSource.html#aeef62b7f4ed3d7c36e3ee33b68b18c0a">EGS_RadionuclideSource::getShowerIndex</a></div><div class="ttdeci">EGS_I64 getShowerIndex() const</div><div class="ttdoc">Returns the shower index of the most recent particle.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8h_source.html#l01036">egs_radionuclide_source.h:1036</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSpectrum_html"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html">EGS_RadionuclideSpectrum</a></div><div class="ttdoc">A radionuclide spectrum.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8h_source.html#l00645">egs_radionuclide_source.h:645</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSpectrum_html_a4bc1f56cb628f18a6c9af794a7649d26"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#a4bc1f56cb628f18a6c9af794a7649d26">EGS_RadionuclideSpectrum::printSampledEmissions</a></div><div class="ttdeci">void printSampledEmissions()</div><div class="ttdoc">Print the sampled emission intensities.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8cpp_source.html#l00638">egs_radionuclide_source.cpp:638</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSpectrum_html_a6c358434a6c7aa0e94d1cf6707dc85af"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#a6c358434a6c7aa0e94d1cf6707dc85af">EGS_RadionuclideSpectrum::EGS_RadionuclideSpectrum</a></div><div class="ttdeci">EGS_RadionuclideSpectrum(const string nuclide, const string ensdf_file, const EGS_Float relativeActivity, const string relaxType, const string outputBetaSpectra, const bool scoreAlphasLocally, const bool allowMultiTransition)</div><div class="ttdoc">Construct a radionuclide spectrum.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8cpp_source.html#l00539">egs_radionuclide_source.cpp:539</a></div></div>
<div class="ttc" id="aclassEGS__RadionuclideSpectrum_html_abb64c6df6ae518d3a7cf75166f2ed94c"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#abb64c6df6ae518d3a7cf75166f2ed94c">EGS_RadionuclideSpectrum::sample</a></div><div class="ttdeci">EGS_Float sample(EGS_RandomGenerator *rndm)</div><div class="ttdoc">Sample an event from the spectrum, returns the energy of the emitted particle.</div><div class="ttdef"><b>Definition:</b> <a href="egs__radionuclide__source_8cpp_source.html#l00720">egs_radionuclide_source.cpp:720</a></div></div>
<div class="ttc" id="aclassEGS__RandomGenerator_html"><div class="ttname"><a href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a></div><div class="ttdoc">Base random number generator class. All random number generators should be derived from this class.</div><div class="ttdef"><b>Definition:</b> <a href="egs__rndm_8h_source.html#l00067">egs_rndm.h:67</a></div></div>
<div class="ttc" id="aclassEGS__RandomGenerator_html_abad39a80b392acb3ab7935db0bd94b79"><div class="ttname"><a href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">EGS_RandomGenerator::getUniform</a></div><div class="ttdeci">EGS_Float getUniform()</div><div class="ttdoc">Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).</div><div class="ttdef"><b>Definition:</b> <a href="egs__rndm_8h_source.html#l00103">egs_rndm.h:103</a></div></div>
<div class="ttc" id="aclassEGS__Vector_html"><div class="ttname"><a href="classEGS__Vector.html">EGS_Vector</a></div><div class="ttdoc">A class representing 3D vectors.</div><div class="ttdef"><b>Definition:</b> <a href="egs__vector_8h_source.html#l00057">egs_vector.h:57</a></div></div>
<div class="ttc" id="aegs__application_8h_html"><div class="ttname"><a href="egs__application_8h.html">egs_application.h</a></div><div class="ttdoc">EGS_Application class header file.</div></div>
<div class="ttc" id="aegs__input_8h_html"><div class="ttname"><a href="egs__input_8h.html">egs_input.h</a></div><div class="ttdoc">EGS_Input class header file.</div></div>
<div class="ttc" id="aegs__math_8h_html"><div class="ttname"><a href="egs__math_8h.html">egs_math.h</a></div><div class="ttdoc">Attempts to fix broken math header files.</div></div>
<div class="ttc" id="aegs__radionuclide__source_8h_html"><div class="ttname"><a href="egs__radionuclide__source_8h.html">egs_radionuclide_source.h</a></div><div class="ttdoc">A radionuclide source.</div></div>
<div class="ttc" id="agroup__egspp__main_html_ga02ff22ad01a5d7f52db6fea9c4615286"><div class="ttname"><a href="group__egspp__main.html#ga02ff22ad01a5d7f52db6fea9c4615286">egsStoreI64</a></div><div class="ttdeci">bool EGS_EXPORT egsStoreI64(ostream &amp;data, EGS_I64 n)</div><div class="ttdoc">Writes the 64 bit integer n to the output stream data and returns true on success,...</div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00058">egs_functions.cpp:58</a></div></div>
<div class="ttc" id="agroup__egspp__main_html_ga38c38ac950788399c630481c2b3722f2"><div class="ttname"><a href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a></div><div class="ttdeci">EGS_InfoFunction EGS_EXPORT egsInformation</div><div class="ttdoc">Always use this function for reporting the progress of a simulation and any other type of information...</div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00135">egs_functions.cpp:135</a></div></div>
<div class="ttc" id="agroup__egspp__main_html_ga4454fdf3403e87c098cd55f60dedbe56"><div class="ttname"><a href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a></div><div class="ttdeci">EGS_InfoFunction EGS_EXPORT egsFatal</div><div class="ttdoc">Always use this function for reporting fatal errors.</div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00137">egs_functions.cpp:137</a></div></div>
<div class="ttc" id="agroup__egspp__main_html_ga70ad7f086f097e38f94a573f49a4dd1f"><div class="ttname"><a href="group__egspp__main.html#ga70ad7f086f097e38f94a573f49a4dd1f">egsGetI64</a></div><div class="ttdeci">bool EGS_EXPORT egsGetI64(istream &amp;data, EGS_I64 &amp;n)</div><div class="ttdoc">Reads a 64 bit integer from the stream data and assigns it to n. Returns true on success,...</div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00069">egs_functions.cpp:69</a></div></div>
<div class="ttc" id="agroup__egspp__main_html_gac5a51c4d1a2d49ad111b65c848f45719"><div class="ttname"><a href="group__egspp__main.html#gac5a51c4d1a2d49ad111b65c848f45719">epsilon</a></div><div class="ttdeci">const EGS_Float epsilon</div><div class="ttdoc">The epsilon constant for floating point comparisons.</div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8h_source.html#l00062">egs_functions.h:62</a></div></div>
<div class="ttc" id="agroup__egspp__main_html_gac6ca173a4a5cc865f8506000e3a21cc8"><div class="ttname"><a href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a></div><div class="ttdeci">string egsJoinPath(const string &amp;first, const string &amp;second)</div><div class="ttdoc">Join two path variables (or a path and a file name) using the platform specific directory separator a...</div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00195">egs_functions.cpp:195</a></div></div>
<div class="ttc" id="agroup__egspp__main_html_gadf4109d942f372e48e1dea86c0ca62cb"><div class="ttname"><a href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a></div><div class="ttdeci">EGS_InfoFunction EGS_EXPORT egsWarning</div><div class="ttdoc">Always use this function for reporting warnings.</div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00136">egs_functions.cpp:136</a></div></div>
<div class="ttc" id="astructEGS__RelaxationParticle_html"><div class="ttname"><a href="structEGS__RelaxationParticle.html">EGS_RelaxationParticle</a></div><div class="ttdef"><b>Definition:</b> <a href="egs__atomic__relaxations_8h_source.html#l00043">egs_atomic_relaxations.h:43</a></div></div>
<div class="ttc" id="astructEGS__RelaxationParticle_html_a4e52533007f3370bc9ecf20701f296d1"><div class="ttname"><a href="structEGS__RelaxationParticle.html#a4e52533007f3370bc9ecf20701f296d1">EGS_RelaxationParticle::q</a></div><div class="ttdeci">int q</div><div class="ttdoc">charge (0-photon, -1=electron)</div><div class="ttdef"><b>Definition:</b> <a href="egs__atomic__relaxations_8h_source.html#l00044">egs_atomic_relaxations.h:44</a></div></div>
<div class="ttc" id="astructEGS__RelaxationParticle_html_a9db6f3ddb4a3dbf06fa5e513fd274f8c"><div class="ttname"><a href="structEGS__RelaxationParticle.html#a9db6f3ddb4a3dbf06fa5e513fd274f8c">EGS_RelaxationParticle::E</a></div><div class="ttdeci">EGS_Float E</div><div class="ttdoc">energy in MeV</div><div class="ttdef"><b>Definition:</b> <a href="egs__atomic__relaxations_8h_source.html#l00045">egs_atomic_relaxations.h:45</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.1
</small></address>
</body>
</html>
