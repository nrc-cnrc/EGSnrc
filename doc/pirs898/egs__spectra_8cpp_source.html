<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>EGSnrc C++ class library: /home/rwtownson/EGSnrc/HEN_HOUSE/egs++/egs_spectra.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<script language="JavaScript" type="text/javascript">
    $(document).ready(function(){
    var imgArr = new Array( // relative paths of images
    'linac2.png',
    'egs_isotropic_source.png',
    'egs_conestack.png',
    'car.png',
    'egs_cd_geometry.png',
    'chamber.png',
    'c_in_box.png',
    'egs_collimated_source.png',
    'egs_iplanes.png',
    'egs_point_source.png',
    'linac_s1.png',
    'egs_ndgeometry.png',
    'egs_roundrect_cylinders.png',
    'egs_source_collection.png',
    'egs_xyzrepeater.png',
    'cones.png',
    'egs_prism.png',
    'egs_pyramid.png',
    'I6702.png',
    'egs_xyzgeometry.png',
    'linac1.png'
    );
    var preloadArr = new Array();
    var i;
    /* preload images */
    for(i=0; i < imgArr.length; i++){
    preloadArr[i] = new Image();
    preloadArr[i].src = imgArr[i];
    }
    changeImg();
    var intID = setInterval(changeImg, 5000);
    /* image rotator */
    function changeImg(){
    $('#egsImageScroller').css('background','#000000 url(' + preloadArr[Math.floor(Math.random() * imgArr.length)].src +') center/contain no-repeat');
    }
    });
</script>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="egsImageScroller"></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EGSnrc C++ class library
   &#160;<span id="projectnumber">Report PIRS-898 (2021)</span>
   </div>
   <div id="projectbrief">Iwan Kawrakow, Ernesto Mainegra-Hing, Frederic Tessier, Reid Townson and Blake Walters</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Coding&#160;Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_eb4d01531b9ed501760fe6ab159423ee.html">egs++</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">egs_spectra.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="egs__spectra_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">###############################################################################</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">#  EGSnrc egs++ spectra</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">#  Copyright (C) 2015 National Research Council Canada</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">#  This file is part of EGSnrc.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">#  EGSnrc is free software: you can redistribute it and/or modify it under</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">#  the terms of the GNU Affero General Public License as published by the</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">#  Free Software Foundation, either version 3 of the License, or (at your</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">#  option) any later version.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">#  EGSnrc is distributed in the hope that it will be useful, but WITHOUT ANY</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">#  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">#  FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">#  more details.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">#  You should have received a copy of the GNU Affero General Public License</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">#  along with EGSnrc. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">###############################################################################</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">#  Author:          Iwan Kawrakow, 2005</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">#  Contributors:    Frederic Tessier</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">#                   Reid Townson</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">###############################################################################</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__base__source_8h.html">egs_base_source.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__rndm_8h.html">egs_rndm.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__alias__table_8h.html">egs_alias_table.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__input_8h.html">egs_input.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__math_8h.html">egs_math.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__ensdf_8h.html">egs_ensdf.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__application_8h.html">egs_application.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__advanced__application_8h.html">egs_advanced_application.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;cstdio&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="egs__math_8h.html">egs_math.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#ifndef NO_SSTREAM</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor"></span><span class="preprocessor">    #include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">    #define S_STREAM std::istringstream</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#else</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor"></span><span class="preprocessor">    #include &lt;strstream&gt;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">    #define S_STREAM std::istrstream</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classEGS__BaseSpectrum.html#a0b06e8749abff71c0112a37bbf2b1371">   64</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEGS__BaseSpectrum.html#a0b06e8749abff71c0112a37bbf2b1371">EGS_BaseSpectrum::reportAverageEnergy</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;expected average energy: %g\n&quot;</span>,expectedAverage());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    EGS_Float e=0,de=0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    getSampledAverage(e,de);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;sampled  average energy: %g +/- %g\n&quot;</span>,e,de);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classEGS__MonoEnergy.html">   83</a></span>&#160;<span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00">EGS_EXPORT</a> <a class="code" href="classEGS__MonoEnergy.html">EGS_MonoEnergy</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a> {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classEGS__MonoEnergy.html#ad998d3830ea0f8e60589480390bae6be">   88</a></span>&#160;    <a class="code" href="classEGS__MonoEnergy.html#ad998d3830ea0f8e60589480390bae6be">EGS_MonoEnergy</a>(EGS_Float energy) : <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a>(), E(energy) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordtype">char</span> buf[1024];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        sprintf(buf,<span class="stringliteral">&quot;monoenergetic %g MeV&quot;</span>,E);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        type = buf;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    };</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    ~<a class="code" href="classEGS__MonoEnergy.html">EGS_MonoEnergy</a>() {};</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    EGS_Float expectedAverage()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    };</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    EGS_Float maxEnergy()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    };</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    EGS_Float sample(<a class="code" href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a> *) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classEGS__MonoEnergy.html#a848abbe84e650e99b46a2e8ab03f33e8">  105</a></span>&#160;    };</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    EGS_Float E; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;};</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> EGS_Float getGaussianRN(<a class="code" href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a> *rndm) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> have_x = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">static</span> EGS_Float the_x;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (have_x) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        have_x = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">return</span> the_x;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    EGS_Float r = sqrt(-2*log(1-rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>()));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    EGS_Float cphi, sphi;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#a1a8125374996eec60b8e017aca93c047">getAzimuth</a>(cphi,sphi);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    the_x = r*sphi;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    have_x = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">return</span> r*cphi;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;};</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="classEGS__GaussianSpectrum.html">  142</a></span>&#160;<span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00">EGS_EXPORT</a> <a class="code" href="classEGS__GaussianSpectrum.html">EGS_GaussianSpectrum</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a> {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classEGS__GaussianSpectrum.html#a1c14cc1c54fb21b6e8d780bfaf284a9d">  152</a></span>&#160;    <a class="code" href="classEGS__GaussianSpectrum.html#a1c14cc1c54fb21b6e8d780bfaf284a9d">EGS_GaussianSpectrum</a>(EGS_Float mean_energy, EGS_Float Sigma) :</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a>(), Eo(mean_energy), sigma(Sigma) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> (Eo &lt;= 0) <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;EGS_GaussianSpectrum: attempt to construct &quot;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                  <span class="stringliteral">&quot;a spectrum with a negative mean energy (%g)\n&quot;</span>,Eo);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> (sigma &lt; 0) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            sigma = -sigma*0.4246609;    <span class="comment">// i.e. assume</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">// the user has specified FWHM</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordtype">char</span> buf[1024];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        sprintf(buf,<span class="stringliteral">&quot;Gaussian spectrum with Eo = %g and sigma = %g&quot;</span>,Eo,sigma);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        type = buf;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">if</span> (Eo - 5*sigma &gt; 0) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            Emax = Eo + 5*sigma;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            Emax = 2*Eo;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    };</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    ~<a class="code" href="classEGS__GaussianSpectrum.html">EGS_GaussianSpectrum</a>() {};</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    EGS_Float expectedAverage()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">return</span> Eo;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    };</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    EGS_Float maxEnergy()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">return</span> Emax;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    };</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    EGS_Float sample(<a class="code" href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a> *rndm) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        EGS_Float E;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            E = Eo + sigma*getGaussianRN(rndm);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">while</span> (E &lt;= 0 || E &gt; Emax);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classEGS__GaussianSpectrum.html#a88834609bf8e31bbcbd338a00b074677">  185</a></span>&#160;    };</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    EGS_Float  Eo;    </div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classEGS__GaussianSpectrum.html#a2aab18920fcbee2c8a0ccee2d06c57d9">  190</a></span>&#160;    EGS_Float  <a class="code" href="classEGS__GaussianSpectrum.html#a2aab18920fcbee2c8a0ccee2d06c57d9">sigma</a>; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="classEGS__GaussianSpectrum.html#a44cad9def151b6d0615a6472e9a1d8e6">  197</a></span>&#160;    EGS_Float  <a class="code" href="classEGS__GaussianSpectrum.html#a44cad9def151b6d0615a6472e9a1d8e6">Emax</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;};</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classEGS__DoubleGaussianSpectrum.html">  222</a></span>&#160;<span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00">EGS_EXPORT</a> <a class="code" href="classEGS__DoubleGaussianSpectrum.html">EGS_DoubleGaussianSpectrum</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a> {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classEGS__DoubleGaussianSpectrum.html#a717d540073d680bf5eb5f75973c6f732">  229</a></span>&#160;    <a class="code" href="classEGS__DoubleGaussianSpectrum.html#a717d540073d680bf5eb5f75973c6f732">EGS_DoubleGaussianSpectrum</a>(EGS_Float mean_energy, EGS_Float sig_left,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                               EGS_Float sig_right) : <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a>(), Eo(mean_energy),</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        sleft(sig_left), sright(sig_right) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">if</span> (sleft &lt; 0) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            sleft = -sleft*0.4246609;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span> (sright&lt; 0) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            sright= -sright*0.4246609;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        Emax = Eo + 4*sright;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">if</span> (Eo - 4*sleft &lt; 0) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;EGS_DoubleGaussianSpectrum: &quot;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                             <span class="stringliteral">&quot;for Eo=%g, sigma=%g there will be negative energy sampled\n&quot;</span>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        p = sleft/(sleft + sright);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordtype">char</span> buf[1024];</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        sprintf(buf,<span class="stringliteral">&quot;Double Gaussian spectrum with Eo = %g sig(left) = %g&quot;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="stringliteral">&quot; and sig(right) = %g&quot;</span>,Eo,sleft,sright);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        type = buf;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    };</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    ~<a class="code" href="classEGS__DoubleGaussianSpectrum.html">EGS_DoubleGaussianSpectrum</a>() {};</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    EGS_Float maxEnergy()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">return</span> Emax;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    };</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    EGS_Float expectedAverage()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">return</span> Eo + sqrt(2/M_PI)*(sright-sleft);</div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="classEGS__DoubleGaussianSpectrum.html#a511490d4f6afbc3dff2962dcccad3807">  253</a></span>&#160;    };</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    EGS_Float Eo;     </div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="classEGS__DoubleGaussianSpectrum.html#acfa3737583092a81f4f994941a8c6707">  258</a></span>&#160;    EGS_Float <a class="code" href="classEGS__DoubleGaussianSpectrum.html#acfa3737583092a81f4f994941a8c6707">Emax</a>;   </div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classEGS__DoubleGaussianSpectrum.html#aec3ac6bdc71cb1610c0fdf1a9ee1bd59">  259</a></span>&#160;    EGS_Float <a class="code" href="classEGS__DoubleGaussianSpectrum.html#aec3ac6bdc71cb1610c0fdf1a9ee1bd59">sleft</a>;  </div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="classEGS__DoubleGaussianSpectrum.html#a3cbe1241001e367eedc12de9185d6fdc">  260</a></span>&#160;    EGS_Float <a class="code" href="classEGS__DoubleGaussianSpectrum.html#a3cbe1241001e367eedc12de9185d6fdc">sright</a>; </div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classEGS__DoubleGaussianSpectrum.html#a0d2cf16c2766f06f2ff58a1e0d4e019f">  261</a></span>&#160;    EGS_Float <a class="code" href="classEGS__DoubleGaussianSpectrum.html#a0d2cf16c2766f06f2ff58a1e0d4e019f">p</a>;      </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    EGS_Float sample(<a class="code" href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a> *rndm) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        EGS_Float E;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">if</span> (rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>() &lt; p) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                E = Eo-sleft*fabs(getGaussianRN(rndm));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordflow">while</span> (E &lt;= 0);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                E = Eo+sright*fabs(getGaussianRN(rndm));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keywordflow">while</span> (E &gt; Emax);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    };</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;};</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classEGS__UniformSpectrum.html">  301</a></span>&#160;<span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00">EGS_EXPORT</a> <a class="code" href="classEGS__UniformSpectrum.html">EGS_UniformSpectrum</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a> {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classEGS__UniformSpectrum.html#ae37406269047422369408d6813427ead">  306</a></span>&#160;    <a class="code" href="classEGS__UniformSpectrum.html#ae37406269047422369408d6813427ead">EGS_UniformSpectrum</a>(EGS_Float emin, EGS_Float emax) : <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a>(),</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        Emin(emin), Emax(emax), de(emax - emin) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordtype">char</span> buf[1024];</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        sprintf(buf,<span class="stringliteral">&quot;Uniform spectrum with Emin = %g Emax = %g&quot;</span>,Emin,Emax);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        type = buf;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    };</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    ~<a class="code" href="classEGS__UniformSpectrum.html">EGS_UniformSpectrum</a>() {};</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    EGS_Float maxEnergy()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">return</span> Emax;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    };</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    EGS_Float expectedAverage()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">return</span> (Emin+Emax)/2;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    };</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    EGS_Float sample(<a class="code" href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a> *rndm) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">return</span> Emin + rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>()*de;</div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="classEGS__UniformSpectrum.html#a33cebc7231ab2467473ee6628c1f37a0">  324</a></span>&#160;    };</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    EGS_Float Emin;  </div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="classEGS__UniformSpectrum.html#a1baf93b8a88e784fe73b2d7167c9c822">  327</a></span>&#160;    EGS_Float <a class="code" href="classEGS__UniformSpectrum.html#a1baf93b8a88e784fe73b2d7167c9c822">Emax</a>;  </div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classEGS__UniformSpectrum.html#a3937d64b5889e738a3383569b9f015d9">  328</a></span>&#160;    EGS_Float <a class="code" href="classEGS__UniformSpectrum.html#a3937d64b5889e738a3383569b9f015d9">de</a>;    </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;};</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="classEGS__TabulatedSpectrum.html">  383</a></span>&#160;<span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00">EGS_EXPORT</a> <a class="code" href="classEGS__TabulatedSpectrum.html">EGS_TabulatedSpectrum</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a> {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classEGS__TabulatedSpectrum.html#ab0e988a46cdc3730a4086c273c917e9e">  401</a></span>&#160;    <a class="code" href="classEGS__TabulatedSpectrum.html#ab0e988a46cdc3730a4086c273c917e9e">EGS_TabulatedSpectrum</a>(<span class="keywordtype">int</span> N, <span class="keyword">const</span> EGS_Float *x, <span class="keyword">const</span> EGS_Float *f,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                          <span class="keywordtype">int</span> Type = 1, <span class="keyword">const</span> <span class="keywordtype">char</span> *fname = 0) : <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a>(),</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        table(new <a class="code" href="classEGS__AliasTable.html">EGS_AliasTable</a>(N,x,f,Type)) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        setType(Type,fname);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    };</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    ~<a class="code" href="classEGS__TabulatedSpectrum.html">EGS_TabulatedSpectrum</a>() {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keyword">delete</span> table;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    };</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    EGS_Float maxEnergy()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">return</span> table-&gt;getMaximum();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    };</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    EGS_Float expectedAverage()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">return</span> table-&gt;getAverage();</div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classEGS__TabulatedSpectrum.html#a4e4a62f9fd0653c4c3bfee5a9aaa04d8">  415</a></span>&#160;    };</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="classEGS__AliasTable.html">EGS_AliasTable</a> *table; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">void</span> setType(<span class="keywordtype">int</span> Type,<span class="keyword">const</span> <span class="keywordtype">char</span> *fname) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">if</span> (Type == 0) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            type = <span class="stringliteral">&quot;tabulated line spectrum&quot;</span>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Type == 1) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            type = <span class="stringliteral">&quot;tabulated histogram spectrum&quot;</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            type = <span class="stringliteral">&quot;tabulated spectrum&quot;</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (fname) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            type += <span class="stringliteral">&quot; defined in &quot;</span>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            type += fname;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            type += <span class="stringliteral">&quot; defined inline&quot;</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    };</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    EGS_Float sample(<a class="code" href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a> *rndm) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">return</span> table-&gt;<a class="code" href="classEGS__AliasTable.html#aca48994ac0438c385e5e4b22cf977ba2">sample</a>(rndm);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    };</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;};</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideBetaSpectrum.html">  456</a></span>&#160;<span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00">EGS_EXPORT</a> <a class="code" href="classEGS__RadionuclideBetaSpectrum.html">EGS_RadionuclideBetaSpectrum</a> {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideBetaSpectrum.html#a56ceecb0bb2f098cd80f4c60f3f67d2d">  461</a></span>&#160;    <a class="code" href="classEGS__RadionuclideBetaSpectrum.html#a56ceecb0bb2f098cd80f4c60f3f67d2d">EGS_RadionuclideBetaSpectrum</a>(<a class="code" href="classEGS__Ensdf.html">EGS_Ensdf</a> *decays, <span class="keyword">const</span> <span class="keywordtype">string</span> outputBetaSpectra) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="classEGS__Application.html">EGS_Application</a> *app = <a class="code" href="classEGS__Application.html#a0bacaf36aa14a5851c5dd6f8efd679ee">EGS_Application::activeApplication</a>();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        rm = app-&gt;getRM();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        vector&lt;BetaRecordLeaf *&gt; myBetas = decays-&gt;getBetaRecords();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">for</span> (vector&lt;BetaRecordLeaf *&gt;::iterator beta = myBetas.begin();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                beta != myBetas.end(); beta++) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="comment">// Skip electron capture records</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">if</span> ((*beta)-&gt;getCharge() == 1 &amp;&amp;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    (*beta)-&gt;getPositronIntensity() == 0) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> daughterZ = (*beta)-&gt;getZ();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideBetaSpectrum: &quot;</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                           <span class="stringliteral">&quot;Energy, Z, A, forbidden: %f %d %d %d\n&quot;</span>,</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                           (*beta)-&gt;getFinalEnergy(), daughterZ,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                           (*beta)-&gt;getAtomicWeight(), (*beta)-&gt;getForbidden()</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                          );</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nbin=1000;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            EGS_Float *e = <span class="keyword">new</span> EGS_Float [nbin];</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            EGS_Float *spec = <span class="keyword">new</span> EGS_Float [nbin];</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            EGS_Float *spec_y = <span class="keyword">new</span> EGS_Float [nbin];</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordtype">double</span> de, s_y, factor, se_y;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            ncomps=1; <span class="comment">// if we increase this, then we must fill the remainder</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            area[0]=1.0;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            rel[0]=1.0;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            emax = (*beta)-&gt;getFinalEnergy();</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            zzz[0] = (double)daughterZ;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            rmass = (*beta)-&gt;getAtomicWeight();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="comment">// These are some special cases where fudge factors are used!</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="comment">// Specify lamda[0]=4 for special shape factors</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="comment">// For Cl-36 (ref: nuc. phys. 99a,  625,(67))</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="comment">// Only the beta- spectrum</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordflow">if</span> (daughterZ == 18 &amp;&amp; (*beta)-&gt;getCharge() == -1) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                lamda[0] = 4;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="comment">// For I-129 (ref: phys. rev. 95, 458, 54))</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="comment">// The beta- spectrum with 151 keV endpoint</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (daughterZ == 54 &amp;&amp; emax &lt; 0.154 &amp;&amp; emax &gt; 0.150) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                lamda[0] = 4;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="comment">// For Cs-137 (ref: nuc. phys. 112a, 156, (68))</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="comment">// The beta- spectrum with 1175 keV endpoint</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (daughterZ == 56 &amp;&amp; emax &gt; 1.173 &amp;&amp; emax &lt; 1.177) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                lamda[0] = 4;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <span class="comment">// For Tl-204 (ref: can. j. phys., 45, 2621, (67))</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="comment">// There is only 1 beta- spectrum</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (daughterZ == 82) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                lamda[0] = 4;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="comment">// For Bi-210 (ref: nuc. phys., 31, 293, (62))</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="comment">// There is only 1 beta- spectrum</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (daughterZ == 84) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                lamda[0] = 4;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                lamda[0] = (*beta)-&gt;getForbidden();</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="comment">// For positrons from zzz negative (just how the spectrum code</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="comment">// was designed)</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="keywordflow">if</span> ((*beta)-&gt;getCharge() == 1) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                zzz[0] *= -1;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            etop[0]=emax;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="comment">// prbs july 9, 2007 moved here from before src loop.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="comment">// also, now tabulate based on</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="comment">// endpoint, using roughly nbin bins across spectrum. Do this by</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="comment">// rounding</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="comment">// endpoint E0 up to nearest 100 keV, and dividing by NBIN to get</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="comment">// binwidth.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            de=((int)(etop[0]*10.0+1)/10.)/nbin; <span class="comment">// round up to nearest 100kev;</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="comment">// /=     NBIN</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="comment">//cout &lt;&lt; &quot;Binwidth &quot; &lt;&lt; de &lt;&lt; endl;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ib=0; ib&lt;nbin; ib++) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                e[ib]=de+ib*de;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">//                 egsInformation(&quot;%.12f, %.12f\n&quot;, e[ib], etop[0]);</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            s_y=0.0;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            se_y=0.0;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ib=0; ib&lt;nbin; ib++) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <span class="keywordflow">if</span> (e[ib]&lt;=emax) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    sp(e[ib],spec_y[ib],factor);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                    spec_y[ib]=0.0;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                s_y=s_y+spec_y[ib];</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                se_y=se_y+spec_y[ib]*e[ib];</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ib=0; ib&lt;nbin; ib++) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                spec[ib]=1/de*(spec_y[ib]/s_y);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">//                 cout &lt;&lt; e[ib] &lt;&lt; &quot; &quot; &lt;&lt; spec[ib] &lt;&lt; endl;</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <a class="code" href="classEGS__AliasTable.html">EGS_AliasTable</a> *bspec = <span class="keyword">new</span> <a class="code" href="classEGS__AliasTable.html">EGS_AliasTable</a>(nbin,e,spec,1);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            (*beta)-&gt;setSpectrum(bspec);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="comment">// Write the spectrum to a file</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordflow">if</span> (outputBetaSpectra == <span class="stringliteral">&quot;yes&quot;</span>) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                ostringstream ostr;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                ostr &lt;&lt; decays-&gt;radionuclide &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; emax &lt;&lt; <span class="stringliteral">&quot;.spec&quot;</span>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideBetaSpectrum: Outputting beta spectrum to file: %s\n&quot;</span>, ostr.str().c_str());</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                ofstream specStream;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                specStream.open(ostr.str().c_str());</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ib=0; ib&lt;nbin; ib++) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                    spec[ib]=1/de*(spec_y[ib]/s_y);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    specStream &lt;&lt; e[ib] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; spec[ib] &lt;&lt; endl;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                specStream.close();</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    complex&lt;double&gt; cgamma(complex&lt;double&gt; z) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> g=7;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> pi = 3.1415926535897932384626433832795028841972;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> p[g+2] = {0.99999999999980993, 676.5203681218851,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                      -1259.1392167224028,</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                                      771.32342877765313,</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                      -176.61502916214059,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                      12.507343278686905,</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                      -0.13857109526572012,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                      9.9843695780195716e-6,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                      1.5056327351493116e-7</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                     };</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (real(z)&lt;0.5) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="keywordflow">return</span> pi / (sin(pi*z)*cgamma(<span class="keywordtype">double</span>(1.0)-z));</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        z -= 1.0;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        complex&lt;double&gt; x=p[0];</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;g+2; i++) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            x += p[i]/(z+complex&lt;double&gt;(i,0));</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        complex&lt;double&gt; t = z + (g + double(0.5));</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">return</span> double(sqrt(2.*pi)) * pow(t,z+<span class="keywordtype">double</span>(0.5)) * exp(-t) * x;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    complex&lt;double&gt; clgamma(complex&lt;double&gt; z) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        complex&lt;double&gt; u, v, h, p, r;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> pi = 3.1415926535897932384626433832795028841972;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> c1 = 9.189385332046727e-1;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> c2 = 1.144729885849400;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> c[10] = {8.333333333333333e-2,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                     -2.777777777777777e-3,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                     7.936507936507936e-4,</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                     -5.952380952380952e-4,</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                     8.417508417508417e-4,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                     -1.917526917526917e-3,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                     6.410256410256410e-3,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                     -2.955065359477124e-2,</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                     1.796443723688305e-1,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                     -1.392432216905901</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                    };</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> hf = 0.5;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordtype">double</span> x = real(z);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordtype">double</span> y = imag(z);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        h = 0;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordflow">if</span> (y == 0 &amp;&amp; -abs(x) == <span class="keywordtype">int</span>(x)) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordtype">double</span> ya = abs(y);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keywordflow">if</span> (x &lt; 0) {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                u = double(1.) - complex&lt;double&gt;(x, ya);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                u = complex&lt;double&gt;(x, ya);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            h = 0;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordtype">double</span> ur = real(u);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="keywordtype">double</span> ui, a;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordflow">if</span> (ur &lt; 7.) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                ui = imag(u);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                a = atan2(ui,ur);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                h = u;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=6-int(ur); i++) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    ur = ur + 1;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    u = complex&lt;double&gt;(ur, ui);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    h = h * u;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    a = a + atan2(ui, ur);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                h = complex&lt;double&gt;(hf * log(pow(real(h),2) + pow(imag(h),2)),</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                    a);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                u = double(1.) + u;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            r = double(1.) / pow(u,2);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            p = r * c[9];</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=8; i&gt;=1; i--) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                p = r * (c[i] + p);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            h = c1 + (u-hf)*log(u) - u + (c[0]+p) / u - h;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="keywordflow">if</span> (x &lt; 0.) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                ur = double(<span class="keywordtype">int</span>(x)) - 1.;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                ui = pi * (x-ur);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                x = pi * ya;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordtype">double</span> t = exp(-x-x);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                a = sin(ui);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                t = x + hf * log(t*pow(a,2)+pow(hf*(1.-t),2));</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                a = atan2(cos(ui)*tanh(x),a) - ur*pi;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                h = c2 - complex&lt;double&gt;(t,a) - h;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <span class="keywordflow">if</span> (y &lt; 0) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                h = conj(h);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">return</span> h;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordtype">void</span> slfact(<span class="keywordtype">double</span> p, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> radf, <span class="keywordtype">double</span> xl[4]) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordtype">double</span> ff[4];</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordtype">double</span> dfac[4]= {1.0, 3.0, 15.0, 105.0};</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordtype">double</span> pi,c137,az,w,rad,pr,y,x1,gk,bb,cc,dd,x2;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        complex&lt;double&gt; aa;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        pi  = acos(-1.0);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        c137= 137.036; <span class="comment">// 1/ fine structure constant</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        az  = z/c137;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        w   = sqrt(p*p+1.0);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        rad = radf/386.159;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        pr  = p*rad;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        y   = az*w/p;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=1; k&lt;=4; k++) {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            gk = sqrt(k*k-az*az);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            x1 = pow((pow(p,k-1)/dfac[k-1]), 2);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            aa = clgamma(complex&lt;double&gt;(gk,y));</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordtype">double</span> aa_real = real(aa);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            bb=lgamma((<span class="keywordtype">double</span>)k);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            cc=lgamma(2.0*k +1.0);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            dd=lgamma(2.0*gk+1.0);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            ff[k-1] =</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                pow(2.0*pr, 2.0*(gk-k)) *</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                exp(pi*y+2.0*(aa_real+cc-bb-dd)) *</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                (k+gk)/(2.0*k);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            x2 =</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                1.0 -</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                az*pr*(2.0*w*(2.0*k+1.0)/(p*k*(2.0*gk+1.0)) -</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                       2.0*p*gk/(w*k*(2.0*gk+1.0))) -</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                2.0*k*pr*pr/((2.0*k+1.0)*(k+gk));</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            xl[k-1] = x1*ff[k-1]/ff[0]*x2;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordtype">void</span> bsp(<span class="keywordtype">double</span> e, <span class="keywordtype">double</span> &amp;bspec, <span class="keywordtype">double</span> &amp;factor) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="comment">// *****************************************************************</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="comment">//     Calculates n(e) (unnormalized) for one spectral component,</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="comment">//     specified by:zz,emax,lamda, where</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="comment">//     lamda = 1  first  forbidden</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="comment">//     lamda = 2  second forbidden</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="comment">//     lamda = 3  third  forbidden</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="comment">//     lamda = 0  otherwise</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="comment">//     lamda = 4  for a few nuclides whose experimental shape don&#39;t</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="comment">//                fit theory. fudge factors are applied to the allowed</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="comment">//                shape.</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="comment">//     zz         charge of the daughter nucleus</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment">//     emax       maximum beta energy in mev.</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="comment">//     w and tsq   in mc**2 units</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="comment">//     e and emax  in mev   units.</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">//     v is the screening correction for atomic electrons</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="comment">//     for the thomas-fermi model of the atom</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="comment">//     v = 1.13 * (alpha)**2  * z**(4/3)</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordtype">double</span> pi,c137,zab,v,z,x,w,psq,p,y,qsq,g,cab,f,radf;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordtype">double</span> xl[4];</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        complex&lt;double&gt; c;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        complex&lt;double&gt; a;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        bspec=0.0;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">if</span> (e&gt;emax) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        pi  =acos(-1.);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        c137=137.036;           <span class="comment">// 1/ fine structure constant</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        zab = abs(zz);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        v   = 1.13*pow(zab,1.333)/pow(c137,2); <span class="comment">// Screening correction</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        v   = copysign(v,zz);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        z   = zab/c137;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        x   = sqrt(1.0-z*z);        <span class="comment">// s parameter</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        w   = 1.0+(e/rm)-v;    <span class="comment">// Total energy of b particle</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">if</span> (w&lt;1.0000001) {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            bspec = 0.;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="comment">//if(w&lt;1.00001) w=1.00001;</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        psq = w*w-double(1.0);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        p   = sqrt(psq);          <span class="comment">// Momemtum of beta particle</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        y   = z*w/p;              <span class="comment">// eta = alpha * z * e / p</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        y   = copysign(y,zz);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        qsq = 3.83*pow(emax-e,2);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">if</span> (e &lt;= 1.0e-5) {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            g=0.0;              <span class="comment">// Low energy approximation</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="keywordflow">if</span> (zz&gt;=0.0) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                g = qsq*2.0*pi*pow(z,(2.0*x-1.0));</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            a   = complex&lt;double&gt;(x,y);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            c   = cgamma(a);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            cab = abs(c);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            f   = pow(psq,x-1.0)*exp(pi*y)*pow(cab,2);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            g   = f*p*w*qsq;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        factor  = 1.0; <span class="comment">// Necessary to calculate kurie plot (not done)</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        bspec   = g;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordflow">if</span> (lam == 0) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        radf = 1.2*pow(rmass,0.333); <span class="comment">// Nuclear radius</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        slfact(p,zz,radf,xl);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">if</span> (lam==1) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            bspec = g*(qsq*xl[0]+9.0*xl[1]);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lam==2) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            bspec = g*(pow(qsq,2)*xl[0]+30.0*qsq*xl[1]+225.0*xl[2]);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        }</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lam==3) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            bspec = g*(pow(qsq,3.0)*xl[0]+63.0*pow(qsq,2)*xl[1]+</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                       1575.0*qsq*xl[2] + 11025.0*xl[3]);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordflow">else</span> { <span class="comment">// lam==4</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="comment">// Fudge factors for nuclides whose experimental spectra don&#39;t</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="comment">// seem to fit theory.</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="comment">//     for cl36 (ref: nuc. phys. 99a,  625,(67))</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">if</span> (zab == 18.0) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                bspec = bspec*(qsq*xl[0]+20.07*xl[1]);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="comment">//     for i129 (ref: phys. rev. 95, 458, 54))</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordflow">if</span> (zab == 54.) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                bspec = bspec*(psq+10.0*qsq);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="comment">//     for cs-ba137 (ref: nuc. phys. 112a, 156, (68))</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="keywordflow">if</span> (zab == 56.) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                bspec = bspec*(qsq*xl[0]+0.045*xl[1]);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            <span class="comment">//     for tl204 (ref: can. j. phys., 45, 2621, (67))</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            <span class="keywordflow">if</span> (zab == 82.) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                bspec = bspec*(1.0-1.677*e+ 2.77*e*e);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="comment">//     for bi210 (ref: nuc. phys., 31, 293, (62))</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <span class="keywordflow">if</span> (zab == 84.) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                bspec = bspec*(1.78-2.35*e+e*e);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">// Sums weighted, normalized spectral components to give total spectrum</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordtype">void</span> sp(<span class="keywordtype">double</span> e, <span class="keywordtype">double</span> &amp;spec, <span class="keywordtype">double</span> &amp;factor) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordtype">double</span> bspec;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        spec=0.0;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icomp=0; icomp&lt;ncomps; icomp++) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            zz  = zzz[icomp];</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            emax= etop[icomp];</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            lam = lamda[icomp];</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            bsp(e,bspec,factor);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            spec= spec+bspec*rel[icomp]/area[icomp];</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    EGS_Float rm;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordtype">double</span> zz,emax,rmass;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordtype">double</span> zzz[9],etop[9],rel[9],area[9],lamda[9];</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordtype">int</span> lam, ncomps;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;};</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html"> 1018</a></span>&#160;<span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00">EGS_EXPORT</a> <a class="code" href="classEGS__RadionuclideSpectrum.html">EGS_RadionuclideSpectrum</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a> {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01024"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#a6c358434a6c7aa0e94d1cf6707dc85af"> 1024</a></span>&#160;    <a class="code" href="classEGS__RadionuclideSpectrum.html#a6c358434a6c7aa0e94d1cf6707dc85af">EGS_RadionuclideSpectrum</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> nuclide, <span class="keyword">const</span> <span class="keywordtype">string</span> ensdf_file,</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                             <span class="keyword">const</span> EGS_Float relativeActivity, <span class="keyword">const</span> <span class="keywordtype">string</span> relaxType, <span class="keyword">const</span> <span class="keywordtype">string</span> outputBetaSpectra, <span class="keyword">const</span> <span class="keywordtype">bool</span> scoreAlphasLocally, <span class="keyword">const</span> <span class="keywordtype">bool</span> allowMultiTransition) :</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a>() {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="comment">// For now, hard-code verbose mode</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="comment">// 0 - minimal output</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="comment">// 1 - some output of ensdf data and normalized intensities</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="comment">// 2 - verbose output</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordtype">int</span> verbose = 0;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <span class="comment">// Read in the data file for the nuclide</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <span class="comment">// and build the decay structure</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        decays = <span class="keyword">new</span> <a class="code" href="classEGS__Ensdf.html">EGS_Ensdf</a>(nuclide, ensdf_file, relaxType, allowMultiTransition, verbose);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="comment">// Normalize the emission and transition intensities</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        decays-&gt;normalizeIntensities();</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="comment">// Get the beta energy spectra</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        betaSpectra = <span class="keyword">new</span> <a class="code" href="classEGS__RadionuclideBetaSpectrum.html">EGS_RadionuclideBetaSpectrum</a>(decays, outputBetaSpectra);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="comment">// Get the particle records from the decay scheme</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        myBetas = decays-&gt;getBetaRecords();</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        myAlphas = decays-&gt;getAlphaRecords();</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        myGammas = decays-&gt;getGammaRecords();</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        myMetastableGammas = decays-&gt;getMetastableGammaRecords();</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        myUncorrelatedGammas = decays-&gt;getUncorrelatedGammaRecords();</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        myLevels = decays-&gt;getLevelRecords();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        xrayIntensities = decays-&gt;getXRayIntensities();</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        xrayEnergies = decays-&gt;getXRayEnergies();</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        augerIntensities = decays-&gt;getAugerIntensities();</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        augerEnergies = decays-&gt;getAugerEnergies();</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="comment">// Initialization</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        currentLevel = 0;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        Emax = 0;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        currentTime = 0;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        ishower = -1; <span class="comment">// Start with ishower -1 so first shower has index 0</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        totalGammaEnergy = 0;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        relaxationType = relaxType;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        scoreAlphasLocal = scoreAlphasLocally;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="comment">// Get the maximum energy for emissions</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordflow">for</span> (vector&lt;BetaRecordLeaf *&gt;::iterator beta = myBetas.begin();</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                beta != myBetas.end(); beta++) {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <span class="keywordtype">double</span> energy = (*beta)-&gt;getFinalEnergy();</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordflow">if</span> (Emax &lt; energy) {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                Emax = energy;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">for</span> (vector&lt;AlphaRecord *&gt;::iterator alpha = myAlphas.begin();</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                alpha != myAlphas.end(); alpha++) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keywordtype">double</span> energy = (*alpha)-&gt;getFinalEnergy();</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            <span class="keywordflow">if</span> (Emax &lt; energy) {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                Emax = energy;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myGammas.begin();</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                gamma != myGammas.end(); gamma++) {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            <span class="keywordtype">double</span> energy = (*gamma)-&gt;getDecayEnergy();</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <span class="keywordflow">if</span> (Emax &lt; energy) {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                Emax = energy;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myUncorrelatedGammas.begin();</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                gamma != myUncorrelatedGammas.end(); gamma++) {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <span class="keywordtype">double</span> energy = (*gamma)-&gt;getDecayEnergy();</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="keywordflow">if</span> (Emax &lt; energy) {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                Emax = energy;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; xrayEnergies.size(); ++i) {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            numSampledXRay.push_back(0);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            <span class="keywordflow">if</span> (Emax &lt; xrayEnergies[i]) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                Emax = xrayEnergies[i];</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; augerEnergies.size(); ++i) {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            numSampledAuger.push_back(0);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordflow">if</span> (Emax &lt; augerEnergies[i]) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                Emax = augerEnergies[i];</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="comment">// Set the weight of the spectrum</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        spectrumWeight = relativeActivity;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordflow">if</span> (verbose) {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSpectrum: Emax: %f\n&quot;</span>,Emax);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_RadionuclideSpectrum: Relative activity: %f\n&quot;</span>,relativeActivity);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="comment">// Set the application</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        app = <a class="code" href="classEGS__Application.html#a0bacaf36aa14a5851c5dd6f8efd679ee">EGS_Application::activeApplication</a>();</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    };</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div>
<div class="line"><a name="l01124"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#a20a72c6a9cde8246cbdfe42e23df362d"> 1124</a></span>&#160;    <a class="code" href="classEGS__RadionuclideSpectrum.html#a20a72c6a9cde8246cbdfe42e23df362d">~EGS_RadionuclideSpectrum</a>() {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keywordflow">if</span> (decays) {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <span class="keyword">delete</span> decays;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keywordflow">if</span> (betaSpectra) {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keyword">delete</span> betaSpectra;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    };</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div>
<div class="line"><a name="l01140"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#aa385c4146f0c49f6eff460434e383e75"> 1140</a></span>&#160;    EGS_Float <a class="code" href="classEGS__RadionuclideSpectrum.html#aa385c4146f0c49f6eff460434e383e75">maxEnergy</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">return</span> Emax;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    };</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#ac77881fe4dfefa8c5b73697e974bfb24"> 1145</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classEGS__RadionuclideSpectrum.html#ac77881fe4dfefa8c5b73697e974bfb24">getCharge</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">return</span> currentQ;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div>
<div class="line"><a name="l01150"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#abbf147294c7c2dee48918ca4c903a342"> 1150</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classEGS__RadionuclideSpectrum.html#abbf147294c7c2dee48918ca4c903a342">getTime</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="keywordflow">return</span> currentTime;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div>
<div class="line"><a name="l01155"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#a777f749a1586f3739607f4b6302382fa"> 1155</a></span>&#160;    EGS_I64 <a class="code" href="classEGS__RadionuclideSpectrum.html#a777f749a1586f3739607f4b6302382fa">getShowerIndex</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">return</span> ishower;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div>
<div class="line"><a name="l01160"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#ad425995e7a729d5f83c8af0f9920e221"> 1160</a></span>&#160;    EGS_Float <a class="code" href="classEGS__RadionuclideSpectrum.html#ad425995e7a729d5f83c8af0f9920e221">getEdep</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <span class="keywordflow">return</span> edep;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div>
<div class="line"><a name="l01165"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#a42b252a24baabff574ea432d1c7d12f9"> 1165</a></span>&#160;    EGS_Float <a class="code" href="classEGS__RadionuclideSpectrum.html#a42b252a24baabff574ea432d1c7d12f9">getSpectrumWeight</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <span class="keywordflow">return</span> spectrumWeight;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div>
<div class="line"><a name="l01170"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#af296f62f4a5e6650c086f350650e9d33"> 1170</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classEGS__RadionuclideSpectrum.html#af296f62f4a5e6650c086f350650e9d33">setSpectrumWeight</a>(EGS_Float newWeight) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        spectrumWeight = newWeight;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div>
<div class="line"><a name="l01192"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#ac244e1d5382b53c70874139aaa022040"> 1192</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classEGS__RadionuclideSpectrum.html#ac244e1d5382b53c70874139aaa022040">getEmissionType</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="keywordflow">return</span> emissionType;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#a4bc1f56cb628f18a6c9af794a7649d26"> 1198</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classEGS__RadionuclideSpectrum.html#a4bc1f56cb628f18a6c9af794a7649d26">printSampledEmissions</a>() {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;\nSampled %s emissions:\n&quot;</span>, decays-&gt;radionuclide.c_str());</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;========================\n&quot;</span>);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">if</span> (ishower &lt; 1) {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;EGS_RadionuclideSpectrum::printSampledEmissions: Warning: The number of disintegrations (tracked by `ishower`) is less than 1.\n&quot;</span>);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Energy | Intensity per 100 decays (adjusted by %f)\n&quot;</span>, decays-&gt;decayDiscrepancy);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">if</span> (myBetas.size() &gt; 0) {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Beta records:\n&quot;</span>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="keywordflow">for</span> (vector&lt;BetaRecordLeaf *&gt;::iterator beta = myBetas.begin();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                beta != myBetas.end(); beta++) {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f\n&quot;</span>, (*beta)-&gt;getFinalEnergy(),</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                           ((EGS_Float)(*beta)-&gt;getNumSampled()/(ishower+1))*100);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="keywordflow">if</span> (myAlphas.size() &gt; 0) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Alpha records:\n&quot;</span>);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="keywordflow">for</span> (vector&lt;AlphaRecord *&gt;::iterator alpha = myAlphas.begin();</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                alpha != myAlphas.end(); alpha++) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f\n&quot;</span>, (*alpha)-&gt;getFinalEnergy(),</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                           ((EGS_Float)(*alpha)-&gt;getNumSampled()/(ishower+1))*100);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="keywordflow">if</span> (myGammas.size() &gt; 0) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Gamma records (E,Igamma,Ice,Ipp):\n&quot;</span>);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        EGS_I64 totalNumSampled = 0;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myGammas.begin();</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                gamma != myGammas.end(); gamma++) {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            totalNumSampled += (*gamma)-&gt;getGammaSampled();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f %.4e %.4e\n&quot;</span>, (*gamma)-&gt;getDecayEnergy(),</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                           ((EGS_Float)(*gamma)-&gt;getGammaSampled()/(ishower+1))*100,</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                           ((EGS_Float)(*gamma)-&gt;getICSampled()/(ishower+1))*100,</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                           ((EGS_Float)(*gamma)-&gt;getIPSampled()/(ishower+1))*100</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                          );</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">if</span> (myGammas.size() &gt; 0) {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            <span class="keywordflow">if</span> (totalNumSampled &gt; 0) {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Average gamma energy: %f\n&quot;</span>,</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                               totalGammaEnergy / totalNumSampled);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            }</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Zero gamma transitions occurred.\n&quot;</span>);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">if</span> (myUncorrelatedGammas.size() &gt; 0) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Uncorrelated gamma records (E,Igamma,Ice,Ipp):\n&quot;</span>);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myUncorrelatedGammas.begin();</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                gamma != myUncorrelatedGammas.end(); gamma++) {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f %.4e %.4e\n&quot;</span>, (*gamma)-&gt;getDecayEnergy(),</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                           ((EGS_Float)(*gamma)-&gt;getGammaSampled()/(ishower+1))*100,</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                           ((EGS_Float)(*gamma)-&gt;getICSampled()/(ishower+1))*100,</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                           ((EGS_Float)(*gamma)-&gt;getIPSampled()/(ishower+1))*100</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                          );</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keywordflow">if</span> (xrayEnergies.size() &gt; 0) {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;X-Ray records:\n&quot;</span>);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; xrayEnergies.size(); ++i) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f\n&quot;</span>, xrayEnergies[i],</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                           ((EGS_Float)numSampledXRay[i]/(ishower+1))*100);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keywordflow">if</span> (augerEnergies.size() &gt; 0) {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;Auger records:\n&quot;</span>);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; augerEnergies.size(); ++i) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;%f %f\n&quot;</span>, augerEnergies[i],</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                           ((EGS_Float)numSampledAuger[i]/(ishower+1))*100);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordtype">bool</span> storeState(ostream &amp;data)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__egspp__main.html#ga02ff22ad01a5d7f52db6fea9c4615286">egsStoreI64</a>(data,ishower);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    }</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordtype">bool</span> setState(istream &amp;data) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__egspp__main.html#ga70ad7f086f097e38f94a573f49a4dd1f">egsGetI64</a>(data,ishower);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordtype">void</span> resetCounter() {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        currentLevel = 0;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        currentTime = 0;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        ishower = -1;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        totalGammaEnergy = 0;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01296"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#abb64c6df6ae518d3a7cf75166f2ed94c"> 1296</a></span>&#160;    EGS_Float <a class="code" href="classEGS__RadionuclideSpectrum.html#abb64c6df6ae518d3a7cf75166f2ed94c">sample</a>(<a class="code" href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a> *rndm) {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="comment">// The energy of the sampled particle</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        EGS_Float E;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="comment">// Local energy depositions</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        edep = 0;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="comment">// Time delay of this particle</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        currentTime = 0;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="comment">// The type of emission particle</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        emissionType = 0;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="comment">// Check for relaxation particles due to shell vacancies in the daughter</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="comment">// These are created from internal transitions or electron capture</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">if</span> (relaxParticles.size() &gt; 0) {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            <span class="comment">// Get the energy and charge of the last particle on the list</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            <a class="code" href="structEGS__RelaxationParticle.html">EGS_RelaxationParticle</a> p = relaxParticles.pop();</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            E = p.<a class="code" href="structEGS__RelaxationParticle.html#a9db6f3ddb4a3dbf06fa5e513fd274f8c">E</a>;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            currentQ = p.<a class="code" href="structEGS__RelaxationParticle.html#a4e52533007f3370bc9ecf20701f296d1">q</a>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            emissionType = 1;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="comment">// Sample a uniform random number</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        EGS_Float u = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="comment">// If the daughter is in an excited state</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="comment">// check for transitions</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">if</span> (currentLevel &amp;&amp; currentLevel-&gt;levelCanDecay() &amp;&amp; currentLevel-&gt;getEnergy() &gt; <a class="code" href="group__egspp__main.html#gac5a51c4d1a2d49ad111b65c848f45719">epsilon</a>) {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myGammas.begin();</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                    gamma != myGammas.end(); gamma++) {</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                <span class="keywordflow">if</span> ((*gamma)-&gt;getLevelRecord() == currentLevel) {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                    <span class="keywordflow">if</span> (u &lt; (*gamma)-&gt;getTransitionIntensity()) {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                        <span class="comment">// A gamma transition may either be a gamma emission</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                        <span class="comment">// or an internal conversion electron</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                        EGS_Float u2 = 0;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                        <span class="keywordflow">if</span> ((*gamma)-&gt;getGammaIntensity() &lt; 1) {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                            u2 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                        }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                        <span class="comment">// Sample how long</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                        <span class="comment">// it took for this transition to occur</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                        <span class="comment">// time = -halflife / ln(2) * log(1-u)</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                        <span class="keywordtype">double</span> hl = currentLevel-&gt;getHalfLife();</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                        <span class="keywordflow">if</span> (hl &gt; 0) {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                            currentTime = -hl * log(1.-rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>()) /</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                          0.693147180559945309417232121458176568075500134360255254120680009493393;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                        }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                        <span class="comment">// Determine whether multiple gamma transitions occur</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                        <span class="keywordflow">if</span> (rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>() &lt; (*gamma)-&gt;getMultiTransitionProb()) {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                            multiTransitions.push_back(currentLevel);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                        }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                        <span class="comment">// Update the level of the daughter</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                        currentLevel = (*gamma)-&gt;getFinalLevel();</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                        <span class="comment">// If a gamma emission occurs</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                        <span class="keywordflow">if</span> (u2 &lt; (*gamma)-&gt;getGammaIntensity()) {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                            (*gamma)-&gt;incrGammaSampled();</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                            currentQ = (*gamma)-&gt;getCharge();</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                            E = (*gamma)-&gt;getDecayEnergy();</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                            totalGammaEnergy += E;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                            emissionType = 2;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                            <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                        }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (u2 &lt; (*gamma)-&gt;getICIntensity()) {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                            (*gamma)-&gt;incrICSampled();</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                            currentQ = -1;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                            emissionType = 3;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                            <span class="keywordflow">if</span> ((*gamma)-&gt;icIntensity.size()) {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                                <span class="comment">// Determine which shell the conversion electron</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                <span class="comment">// comes from. This will create a shell vacancy</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                                EGS_Float u3 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*gamma)-&gt;icIntensity.size(); ++i) {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                                    <span class="keywordflow">if</span> (u3 &lt; (*gamma)-&gt;icIntensity[i]) {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                                        E = (*gamma)-&gt;getDecayEnergy() - (*gamma)-&gt;getBindingEnergy(i);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                        <span class="comment">//                                     egsInformation(&quot;test %d %f %f %f\n&quot;,i,(*gamma)-&gt;getDecayEnergy(),decays-&gt;getRelaxations()-&gt;getBindingEnergy(decays-&gt;Z,i),E);</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                        <span class="comment">// Add relaxation particles to the source stack</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                        <span class="keywordflow">if</span> (relaxationType == <span class="stringliteral">&quot;eadl&quot;</span>) {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                                            <span class="comment">// Generate relaxation particles for a</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                                            <span class="comment">// shell vacancy i</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                                            (*gamma)-&gt;relax(i,app-&gt;getEcut()-app-&gt;getRM(),app-&gt;getPcut(),rndm,edep,relaxParticles);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                                        }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                                        <span class="comment">// Return the conversion electron</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                        <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                                    }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                }</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                            }</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                        }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                            (*gamma)-&gt;incrIPSampled();</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                            emissionType = 13;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                            <span class="comment">// Internal pair production results in a positron</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                            <span class="comment">// and electron pair</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                            <span class="comment">//TODO: This is left for future work, we need to</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                            <span class="comment">// determine the energies of the electron/positron</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                            <span class="comment">// pair (sample uniformly?) and then determine the</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                            <span class="comment">// corresponding directions. It might be best to do</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                            <span class="comment">// this in the source instead of the spectrum.</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                            currentQ = 1;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                        }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                    }</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            currentLevel = 0;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="comment">// If we have determined that multiple transitions will occur from some</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="comment">// levels, here we set the current level to an excited state, and return.</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="comment">// The radionuclide source will then sample again using the excited level.</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordflow">if</span> (multiTransitions.size() &gt; 0) {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            currentLevel = multiTransitions.back();</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            multiTransitions.pop_back();</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        <span class="comment">// ============================</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <span class="comment">// Sample which decay occurs</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="comment">// ============================</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        currentTime = 0;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <span class="comment">// Beta-, beta+ and electron capture</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="keywordflow">for</span> (vector&lt;BetaRecordLeaf *&gt;::iterator beta = myBetas.begin();</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                beta != myBetas.end(); beta++) {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            <span class="keywordflow">if</span> (u &lt; (*beta)-&gt;getBetaIntensity()) {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                <span class="comment">// Increment the shower number</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                ishower++;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                <span class="comment">// Increment the counter of betas and get the charge</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                (*beta)-&gt;incrNumSampled();</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                currentQ = (*beta)-&gt;getCharge();</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                <span class="comment">// Set the energy level of the daughter</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                currentLevel = (*beta)-&gt;getLevelRecord();</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                <span class="comment">// For beta+ records we decide between</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                <span class="comment">// branches for beta+ or electron capture</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                <span class="keywordflow">if</span> (currentQ == 1) {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                    <span class="comment">// For positron emission, continue as usual</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                    <span class="keywordflow">if</span> ((*beta)-&gt;getPositronIntensity() &gt; <a class="code" href="group__egspp__main.html#gac5a51c4d1a2d49ad111b65c848f45719">epsilon</a> &amp;&amp; rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>() &lt; (*beta)-&gt;getPositronIntensity()) {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                    }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                        <span class="keywordflow">if</span> (relaxationType == <span class="stringliteral">&quot;eadl&quot;</span> &amp;&amp; (*beta)-&gt;ecShellIntensity.size()) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                            <span class="comment">// Determine which shell the electron capture</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                            <span class="comment">// occurs in. This will create a shell vacancy</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                            EGS_Float u3 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*beta)-&gt;ecShellIntensity.size(); ++i) {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                                <span class="keywordflow">if</span> (u3 &lt; (*beta)-&gt;ecShellIntensity[i]) {</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                    <span class="comment">// Generate relaxation particles for a</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                    <span class="comment">// shell vacancy i</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                    (*beta)-&gt;relax(i,app-&gt;getEcut()-app-&gt;getRM(),app-&gt;getPcut(),rndm,edep,relaxParticles);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                                    emissionType = 4;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                                }</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                            }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                        }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                        <span class="comment">// For electron capture, there is no emitted particle</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                        <span class="comment">// (only a neutrino)</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                        <span class="comment">// so we return a 0 energy particle</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                        emissionType = 4;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                    }</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                    emissionType = 5;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                }</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                    emissionType = 6;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                <span class="comment">// Sample the energy from the spectrum alias table</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                E = (*beta)-&gt;getSpectrum()-&gt;sample(rndm);</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        }</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <span class="comment">// Alphas</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="keywordflow">for</span> (vector&lt;AlphaRecord *&gt;::iterator alpha = myAlphas.begin();</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                alpha != myAlphas.end(); alpha++) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;            <span class="keywordflow">if</span> (u &lt; (*alpha)-&gt;getAlphaIntensity()) {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                <span class="comment">// Increment the shower number</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                ishower++;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                <span class="comment">// Increment the counter of alphas and get the charge</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                (*alpha)-&gt;incrNumSampled();</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                currentQ = (*alpha)-&gt;getCharge();</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                <span class="comment">// Set the energy level of the daughter</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                currentLevel = (*alpha)-&gt;getLevelRecord();</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                <span class="comment">// Score alpha energy depositions locally,</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                <span class="comment">// because alpha transport is not modeled in EGSnrc.</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                <span class="comment">// This is an approximation!</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                <span class="keywordflow">if</span> (scoreAlphasLocal) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                    edep += (*alpha)-&gt;getFinalEnergy();</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                emissionType = 7;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                <span class="comment">// For alphas we simulate a disintegration but the</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                <span class="comment">// transport will not be performed so return 0</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        <span class="comment">// Metastable &quot;decays&quot; that will result in internal transitions</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myMetastableGammas.begin();</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                gamma != myMetastableGammas.end(); gamma++) {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            <span class="keywordflow">if</span> (u &lt; (*gamma)-&gt;getTransitionIntensity()) {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                <span class="comment">// Increment the shower number</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                ishower++;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                <span class="comment">// Set the energy level of the daughter as though a</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                <span class="comment">// disintegration just occurred</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                currentLevel = (*gamma)-&gt;getLevelRecord();</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                emissionType = 8;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                <span class="comment">// No particle returned</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            }</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="comment">// Uncorrelated internal transitions</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <span class="keywordflow">for</span> (vector&lt;GammaRecord *&gt;::iterator gamma = myUncorrelatedGammas.begin();</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                gamma != myUncorrelatedGammas.end(); gamma++) {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            <span class="keywordflow">if</span> (u &lt; (*gamma)-&gt;getTransitionIntensity()) {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                <span class="comment">// A gamma transition may either be a gamma emission</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                <span class="comment">// or an internal conversion electron</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                EGS_Float u2 = 0;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                <span class="keywordflow">if</span> ((*gamma)-&gt;getGammaIntensity() &lt; 1) {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                    u2 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                <span class="comment">// If a gamma emission occurs</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                <span class="keywordflow">if</span> (u2 &lt; (*gamma)-&gt;getGammaIntensity()) {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                    (*gamma)-&gt;incrGammaSampled();</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    currentQ = (*gamma)-&gt;getCharge();</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                    E = (*gamma)-&gt;getDecayEnergy();</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                    totalGammaEnergy += E;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                    emissionType = 11;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                    <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (u2 &lt; (*gamma)-&gt;getICIntensity()) {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                    (*gamma)-&gt;incrICSampled();</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                    currentQ = -1;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                    emissionType = 12;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                    <span class="keywordflow">if</span> ((*gamma)-&gt;icIntensity.size()) {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                        <span class="comment">// Determine which shell the conversion electron</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                        <span class="comment">// comes from. This will create a shell vacancy</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                        EGS_Float u3 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">getUniform</a>();</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*gamma)-&gt;icIntensity.size(); ++i) {</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                            <span class="keywordflow">if</span> (u3 &lt; (*gamma)-&gt;icIntensity[i]) {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                                E = (*gamma)-&gt;getDecayEnergy() - (*gamma)-&gt;getBindingEnergy(i);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                                <span class="comment">// Add relaxation particles to the source stack</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                                <span class="keywordflow">if</span> (relaxationType == <span class="stringliteral">&quot;eadl&quot;</span>) {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                                    <span class="comment">// Generate relaxation particles for a</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                                    <span class="comment">// shell vacancy i</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                                    (*gamma)-&gt;relax(i,app-&gt;getEcut()-app-&gt;getRM(),app-&gt;getPcut(),rndm,edep,relaxParticles);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                                }</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                                <span class="comment">// Return the conversion electron</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                                <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                            }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                        }</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                    }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                    (*gamma)-&gt;incrIPSampled();</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                    emissionType = 14;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                    <span class="comment">// Internal pair production results in a positron</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                    <span class="comment">// and electron pair</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                    <span class="comment">//TODO: This is left for future work, we need to</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                    <span class="comment">// determine the energies of the electron/positron</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                    <span class="comment">// pair (sample uniformly?) and then determine the</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                    <span class="comment">// corresponding directions. It might be best to do</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                    <span class="comment">// this in the source instead of the spectrum.</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                    currentQ = 1;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <span class="comment">// XRays from the ensdf</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; xrayIntensities.size(); ++i) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            <span class="keywordflow">if</span> (u &lt; xrayIntensities[i]) {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                numSampledXRay[i]++;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                currentQ = 0;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                E = xrayEnergies[i];</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                emissionType = 9;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            }</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        }</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        <span class="comment">// Auger electrons from the ensdf</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; augerIntensities.size(); ++i) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;            <span class="keywordflow">if</span> (u &lt; augerIntensities[i]) {</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                numSampledAuger[i]++;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                currentQ = -1;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                E = augerEnergies[i];</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                emissionType = 10;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                <span class="keywordflow">return</span> E;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            }</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        }</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="comment">// If we get here, fission occurs</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <span class="comment">// Count it as a disintegration and return 0</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        ishower++;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    };</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div>
<div class="line"><a name="l01673"></a><span class="lineno"><a class="line" href="classEGS__RadionuclideSpectrum.html#a09881c2d4c9b7b38df54db8c3eff23ca"> 1673</a></span>&#160;    EGS_Float <a class="code" href="classEGS__RadionuclideSpectrum.html#a09881c2d4c9b7b38df54db8c3eff23ca">expectedAverage</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    };</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <a class="code" href="classEGS__Ensdf.html">EGS_Ensdf</a>                   *decays;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    vector&lt;BetaRecordLeaf *&gt;    myBetas;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    vector&lt;AlphaRecord *&gt;       myAlphas;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    vector&lt;GammaRecord *&gt;       myGammas,</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;           myMetastableGammas,</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;           myUncorrelatedGammas;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    vector&lt;LevelRecord *&gt;       myLevels;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    vector&lt;double&gt;              xrayIntensities,</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;           xrayEnergies,</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;           augerIntensities,</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;           augerEnergies;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    vector&lt;EGS_I64&gt;             numSampledXRay,</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;           numSampledAuger;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    vector&lt;const LevelRecord *&gt; multiTransitions;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <a class="code" href="classEGS__SimpleContainer.html">EGS_SimpleContainer&lt;EGS_RelaxationParticle&gt;</a> relaxParticles;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="keyword">const</span> <a class="code" href="classLevelRecord.html">LevelRecord</a>           *currentLevel;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="keywordtype">int</span>                         currentQ;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                emissionType;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    EGS_Float                   currentTime,</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                                Emax,</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                                spectrumWeight,</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                                totalGammaEnergy,</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                                edep;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    EGS_I64                     ishower;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordtype">string</span>                      relaxationType;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordtype">bool</span>                        scoreAlphasLocal;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <a class="code" href="classEGS__RadionuclideBetaSpectrum.html">EGS_RadionuclideBetaSpectrum</a> *betaSpectra;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <a class="code" href="classEGS__Application.html">EGS_Application</a>             *app;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;};</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">// The following function is used to skip potentially present</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="comment">// commas as separators in spectrum files. With it we can write</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="comment">//   stream &gt;&gt; input1 &gt;&gt; skipsep &gt;&gt; input2;</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="comment">// and it will work for white space and for comma separated input.</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;istream &amp;skipsep(istream &amp;in) {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordtype">char</span> c;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="keywordflow">for</span> (EGS_I64 loopCount=0; loopCount&lt;=<a class="code" href="group__egspp__main.html#gabcfd5e49b56f8b98998f903c4328ef59">loopMax</a>; ++loopCount) {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keywordflow">if</span> (loopCount == <a class="code" href="group__egspp__main.html#gabcfd5e49b56f8b98998f903c4328ef59">loopMax</a>) {</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;            <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;skipsep: Too many iterations were required! Input may be invalid, or consider increasing loopMax.&quot;</span>);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            <span class="keywordflow">return</span> in;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        }</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        in.get(c);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keywordflow">if</span> (in.eof() || in.fail() || !in.good()) {</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;,&#39;</span>) {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        }</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <span class="keywordflow">if</span> (!isspace(c)) {</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            in.putback(c);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">return</span> in;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;}</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> spec_msg1[] = <span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum:&quot;</span>;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"><a class="line" href="classEGS__BaseSpectrum.html#aaf11ec2f02be812666f474537c00940e"> 1740</a></span>&#160;<a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a> *<a class="code" href="classEGS__BaseSpectrum.html#aaf11ec2f02be812666f474537c00940e">EGS_BaseSpectrum::createSpectrum</a>(<a class="code" href="classEGS__Input.html">EGS_Input</a> *input) {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="keywordflow">if</span> (!input) {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s got null input?\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <a class="code" href="classEGS__Input.html">EGS_Input</a> *inp = input;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keywordtype">bool</span> delete_it = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="keywordflow">if</span> (!input-&gt;<a class="code" href="classEGS__Input.html#a4941448779de7f5f6742c7dde00e12c3">isA</a>(<span class="stringliteral">&quot;spectrum&quot;</span>)) {</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        inp = input-&gt;<a class="code" href="classEGS__Input.html#a1fb7e11391a1ab33c23321633d035781">takeInputItem</a>(<span class="stringliteral">&quot;spectrum&quot;</span>);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <span class="keywordflow">if</span> (!inp) {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s no &#39;spectrum&#39; input!\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        }</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        delete_it = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    }</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordtype">string</span> stype;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="keywordtype">int</span> err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;type&quot;</span>,stype);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;type&#39; input\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;            <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        }</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <a class="code" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a> *spec = 0;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(stype,<span class="stringliteral">&quot;monoenergetic&quot;</span>)) {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        EGS_Float Eo;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;energy&quot;</span>,Eo);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <span class="keywordflow">if</span> (err) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;energy&#39; input for a &quot;</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                                <span class="stringliteral">&quot;monoenergetic spectrum\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            spec = <span class="keyword">new</span> <a class="code" href="classEGS__MonoEnergy.html">EGS_MonoEnergy</a>(Eo);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        }</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(stype,<span class="stringliteral">&quot;Gaussian&quot;</span>)) {</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        EGS_Float Eo, sig, fwhm;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="keywordtype">int</span> err1 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;mean energy&quot;</span>,Eo);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <span class="keywordtype">int</span> err2 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;sigma&quot;</span>,sig);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        <span class="keywordtype">int</span> err3 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;fwhm&quot;</span>,fwhm);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <span class="keywordflow">if</span> (err1 || (err2 &amp;&amp; err3)) {</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            <span class="keywordflow">if</span> (err1) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;mean energy&#39; input&quot;</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                                     <span class="stringliteral">&quot; for a Gaussian spectrum\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;sigma&#39; and &#39;FWHM&#39; input for a &quot;</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                                <span class="stringliteral">&quot;Gaussian spectrum\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        }</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            <span class="keywordflow">if</span> (Eo &lt;= 0) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s mean energy must be positive but your&quot;</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                                        <span class="stringliteral">&quot; input was %g\n&quot;</span>,Eo);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                <span class="keywordflow">if</span> (!err2) {</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                    <span class="keywordflow">if</span> (sig &lt;= 0) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s sigma must be positive&quot;</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                                                 <span class="stringliteral">&quot; but your input was %g\n&quot;</span>,spec_msg1,sig);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                        spec = <span class="keyword">new</span> <a class="code" href="classEGS__GaussianSpectrum.html">EGS_GaussianSpectrum</a>(Eo,sig);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                    }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                    <span class="keywordflow">if</span> (fwhm &lt;= 0)  <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s FWHM must be positive&quot;</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                                                   <span class="stringliteral">&quot; but your input was %g\n&quot;</span>,spec_msg1,fwhm);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                        spec = <span class="keyword">new</span> <a class="code" href="classEGS__GaussianSpectrum.html">EGS_GaussianSpectrum</a>(Eo,-fwhm);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                    }</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        }</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(stype,<span class="stringliteral">&quot;Double Gaussian&quot;</span>)) {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        EGS_Float Eo;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        vector&lt;EGS_Float&gt; sig, fwhm;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        <span class="keywordtype">int</span> err1 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;mean energy&quot;</span>,Eo);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <span class="keywordtype">int</span> err2 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;sigma&quot;</span>,sig);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        <span class="keywordtype">int</span> err3 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;fwhm&quot;</span>,fwhm);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        <span class="keywordflow">if</span> (!err1 &amp;&amp; Eo &lt;= 0) {</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            err1 = 1;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        <span class="keywordflow">if</span> (!err2 &amp;&amp; sig.size() != 2) {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            err2 = 1;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        }</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <span class="keywordflow">if</span> (!err2 &amp;&amp; (sig[0] &lt;= 0 || sig[1] &lt;= 0)) {</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            err2 = 1;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        }</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <span class="keywordflow">if</span> (!err3 &amp;&amp; fwhm.size() != 2) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            err3 = 1;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        }</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        <span class="keywordflow">if</span> (!err3 &amp;&amp; (fwhm[0] &lt;= 0 || fwhm[1] &lt;= 0)) {</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            err3 = 1;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="keywordflow">if</span> (err1 || (err2 &amp;&amp; err3)) {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            <span class="keywordflow">if</span> (err1) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;mean energy&#39; input&quot;</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                                     <span class="stringliteral">&quot; for a Double Gaussian spectrum\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            <span class="keywordflow">if</span> (err2 &amp;&amp; err3) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;sigma&#39; and &#39;FWHM&#39;&quot;</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                                             <span class="stringliteral">&quot; input for a Double Gaussian spectrum\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        }</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            <span class="keywordflow">if</span> (!err2 &amp;&amp; !err3) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s found &#39;sigma&#39; and &#39;FWHM&#39; &quot;</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                                               <span class="stringliteral">&quot;input, using &#39;sigma&#39;\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            <span class="keywordflow">if</span> (!err2) {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                spec = <span class="keyword">new</span> <a class="code" href="classEGS__DoubleGaussianSpectrum.html">EGS_DoubleGaussianSpectrum</a>(Eo,sig[0],sig[1]);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                spec = <span class="keyword">new</span> <a class="code" href="classEGS__DoubleGaussianSpectrum.html">EGS_DoubleGaussianSpectrum</a>(Eo,-fwhm[0],-fwhm[1]);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            }</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        }</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(stype,<span class="stringliteral">&quot;uniform&quot;</span>)) {</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        vector&lt;EGS_Float&gt; range;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        EGS_Float Emin, Emax;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <span class="keywordtype">int</span> err1 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;range&quot;</span>,range);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        <span class="keywordtype">int</span> err2 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;minimum energy&quot;</span>,Emin);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        <span class="keywordtype">int</span> err3 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;maximum energy&quot;</span>,Emax);</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <span class="keywordflow">if</span> (!err2 &amp;&amp; !err3 &amp;&amp; Emin &gt; Emax) {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s Emin (%g) is greater than Emax (%g)?\n&quot;</span>,</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                       spec_msg1,Emin,Emax);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            err2 = 1;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            err3 = 1;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="keywordflow">if</span> (err1 &amp;&amp; err2 &amp;&amp; err3) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;range&#39; and&quot;</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                                                 <span class="stringliteral">&quot; &#39;minimum/maximum energy&#39; input\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            <span class="keywordflow">if</span> (!err2 &amp;&amp; !err3) {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                spec = <span class="keyword">new</span> <a class="code" href="classEGS__UniformSpectrum.html">EGS_UniformSpectrum</a>(Emin,Emax);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                <span class="keywordflow">if</span> (range[0] &lt; range[1]) {</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                    spec = <span class="keyword">new</span> <a class="code" href="classEGS__UniformSpectrum.html">EGS_UniformSpectrum</a>(range[0],range[1]);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                }</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                    spec = <span class="keyword">new</span> <a class="code" href="classEGS__UniformSpectrum.html">EGS_UniformSpectrum</a>(range[1],range[0]);</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        }</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(stype,<span class="stringliteral">&quot;tabulated spectrum&quot;</span>)) {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        <span class="keywordtype">string</span> spec_file;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;spectrum file&quot;</span>,spec_file);</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="comment">// Expands FIRST environment variable found in spec_file</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        spec_file = <a class="code" href="group__egspp__main.html#ga63fd04e4564a563f2f099c3eae6426f5">egsExpandPath</a>(spec_file);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            ifstream sdata(spec_file.c_str());</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;            <span class="keywordflow">if</span> (!sdata) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s failed to open spectrum file %s\n&quot;</span>,</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                                       spec_msg1,spec_file.c_str());</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                <span class="keywordtype">char</span> title[1024];</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                sdata.getline(title,1023);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                <span class="keywordflow">if</span> (sdata.eof() || sdata.fail() || !sdata.good()) {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s error while reading title of spectrum file&quot;</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                               <span class="stringliteral">&quot;%s\n&quot;</span>,spec_msg1,spec_file.c_str());</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                    <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                        <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                    }</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                }</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                <span class="keywordflow">if</span> (sdata.eof() || sdata.fail() || !sdata.good()) {</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s error while reading spectrum type and &quot;</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                               <span class="stringliteral">&quot;number of bins in spectrum file %s\n&quot;</span>,</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                               spec_msg1,spec_file.c_str());</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                    <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                        <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                    }</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                EGS_Float dum;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                <span class="keywordtype">int</span> nbin, mode;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                sdata &gt;&gt; nbin &gt;&gt; skipsep &gt;&gt; dum &gt;&gt; skipsep &gt;&gt; mode;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                <span class="keywordflow">if</span> (sdata.eof() || sdata.fail() || !sdata.good()) {</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s error while reading spectrum type and &quot;</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                               <span class="stringliteral">&quot;number of bins in spectrum file %s\n&quot;</span>,</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                               spec_msg1,spec_file.c_str());</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                    <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                        <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                    }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                }</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                <span class="keywordflow">if</span> (nbin &lt; 2) {</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s nbin in a spectrum must be at least 2\n&quot;</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                               <span class="stringliteral">&quot;  you have %d in the spectrum file %s\n&quot;</span>,</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                               spec_msg1,nbin,spec_file.c_str());</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                    <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                        <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                    }</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;                <span class="keywordflow">if</span> (mode &lt; 0 || mode &gt; 3) {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s unknown spectrum type %d in spectrum file&quot;</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                               <span class="stringliteral">&quot; %s\n&quot;</span>,spec_msg1,mode,spec_file.c_str());</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                    <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                        <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                    }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                EGS_Float *en_array, *f_array;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                <span class="keywordtype">int</span> ibin;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                f_array = <span class="keyword">new</span> EGS_Float [nbin];</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                <span class="keywordflow">if</span> (mode == 0 || mode == 1) {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                    en_array = <span class="keyword">new</span> EGS_Float [nbin+1];</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                    en_array[0] = dum;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                    ibin=1;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                    en_array = <span class="keyword">new</span> EGS_Float [nbin];</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                    ibin=0;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                }</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nbin; j++) {</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                    sdata &gt;&gt; en_array[ibin++] &gt;&gt; skipsep &gt;&gt; f_array[j];</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                    <span class="keywordflow">if</span> (sdata.eof() || sdata.fail() || !sdata.good()) {</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                        <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s error on line %d in spectrum file %s\n&quot;</span>,</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                                   spec_msg1,j+2,spec_file.c_str());</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                        <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                            <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                        }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                        <span class="keyword">delete</span> [] en_array;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                        <span class="keyword">delete</span> [] f_array;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                    }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                    <span class="keywordflow">if</span> (mode != 2 &amp;&amp; ibin &gt; 1) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                        <span class="keywordflow">if</span> (en_array[ibin-1] &lt;= en_array[ibin-2]) {</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                            <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s energies must be in increasing &quot;</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                                       <span class="stringliteral">&quot;order.\n   This is not the case for input on &quot;</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                                       <span class="stringliteral">&quot;lines %d,%d in spectrum file %s\n&quot;</span>,</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                                       spec_msg1,j+2,j+1,spec_file.c_str());</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                            <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                                <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                            }</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                        }</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                    }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                    <span class="keywordflow">if</span> (mode == 0) {</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                        f_array[j]/=(en_array[ibin-1]-en_array[ibin-2]);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                    }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                <span class="keywordtype">int</span> itype = 1;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                <span class="keywordflow">if</span> (mode == 2) {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                    itype = 0;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mode == 3) {</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                    itype = 2;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                <span class="keywordtype">int</span> nb = itype == 1 ? nbin+1 : nbin;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                spec = <span class="keyword">new</span> <a class="code" href="classEGS__TabulatedSpectrum.html">EGS_TabulatedSpectrum</a>(nb,en_array,f_array,itype,</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                                                 spec_file.c_str());</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                <span class="keyword">delete</span> [] en_array;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                <span class="keyword">delete</span> [] f_array;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            vector&lt;EGS_Float&gt; eners, probs;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            <span class="keywordtype">int</span> itype=1, mode;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <span class="keywordtype">int</span> err1 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;energies&quot;</span>,eners);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            <span class="keywordtype">int</span> err2 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;probabilities&quot;</span>,probs);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <span class="keywordtype">int</span> err3 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;spectrum mode&quot;</span>,mode);      <span class="comment">// according to EGSnrc convention</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            <span class="keywordflow">if</span> (err3) {</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                err3 = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;spectrum type&quot;</span>,mode);      <span class="comment">// deprecated</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="keywordflow">if</span> (err3) {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;spectrum mode&#39; input\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                    <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                }</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                <span class="keywordflow">if</span> (mode &lt; 0 || mode &gt; 3) {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s unknown spectrum &#39;mode&#39; %d&quot;</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                               <span class="stringliteral">&quot; %s\n&quot;</span>,spec_msg1,mode,spec_file.c_str());</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                    <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                        <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                    }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                <span class="keywordflow">if</span> (mode == 2) {</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                    itype = 0;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mode == 3) {</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                    itype = 2;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;            }</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;            <span class="keywordflow">if</span> (err1 || err2) {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                <span class="keywordflow">if</span> (err1) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;energies&#39; input\n&quot;</span>,</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                                         spec_msg1);</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                <span class="keywordflow">if</span> (err2) <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;probabilities&#39; &quot;</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                                         <span class="stringliteral">&quot;input\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            }</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                <span class="keywordflow">if</span> (itype == 1 &amp;&amp; probs.size() != eners.size()-1)</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s for spectrum type 1 the number of energies&quot;</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                               <span class="stringliteral">&quot; must be the number of probabilities + 1\n&quot;</span>,</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                               spec_msg1);</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((itype == 0 || itype == 2) &amp;&amp;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                         probs.size() != eners.size())</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s for spectrum types 0 and 2 the number of &quot;</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                               <span class="stringliteral">&quot;energies must be equal to the number of probabilities\n&quot;</span>,</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                               spec_msg1);</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                    <span class="keywordtype">int</span> nbin = eners.size();</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                    <span class="keywordtype">int</span> nbin1 = itype == 1 ? nbin-1 : nbin;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                    EGS_Float *x = <span class="keyword">new</span> EGS_Float [nbin],</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                    *f = <span class="keyword">new</span> EGS_Float [nbin1];</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                    <span class="keywordtype">int</span> ibin = 0;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                    <span class="keywordflow">if</span> (itype == 1) {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                        ibin = 1;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                        x[0] = eners[0];</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                    }</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nbin1; j++) {</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                        x[ibin] = eners[ibin];</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                        ibin++;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                        f[j] = mode == 0 ? probs[j]/(eners[ibin-1]-eners[ibin-2]) : probs[j];</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                        <span class="keywordflow">if</span> (itype != 0 &amp;&amp; ibin &gt; 1) {</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                            <span class="keywordflow">if</span> (x[ibin-1] &lt;= x[ibin-2]) {</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                                <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s energies must be given in &quot;</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                                           <span class="stringliteral">&quot;increasing order\n  This is not the case&quot;</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                                           <span class="stringliteral">&quot; for inputs %d and %d (%g,%g) %d\n&quot;</span>,</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                                           spec_msg1,ibin-2,ibin-1,x[ibin-2],x[ibin-1],</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                                           j);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                                <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                                    <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                                }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                                <span class="keyword">delete</span> [] x;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                                <span class="keyword">delete</span> [] f;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                            }</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                        }</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                    }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                    spec = <span class="keyword">new</span> <a class="code" href="classEGS__TabulatedSpectrum.html">EGS_TabulatedSpectrum</a>(nbin,x,f,itype,0);</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                    <span class="keyword">delete</span> [] x;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                    <span class="keyword">delete</span> [] f;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                }</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;            }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        }</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(stype,<span class="stringliteral">&quot;radionuclide&quot;</span>)) {</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Initializing radionuclide spectrum...\n&quot;</span>);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        <span class="keywordtype">string</span> nuclide;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;nuclide&quot;</span>,nuclide);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;            err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;isotope&quot;</span>,nuclide);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;            <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;radionuclide&quot;</span>,nuclide);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s wrong/missing &#39;nuclide&#39; input\n&quot;</span>,spec_msg1);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            }</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        }</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        EGS_Float relativeActivity;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;relative activity&quot;</span>,relativeActivity);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            relativeActivity = 1;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        }</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        <span class="comment">// Determine whether to sample X-Rays and Auger electrons</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        <span class="comment">// using the ensdf data (options: eadl, ensdf or none)</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        <span class="keywordtype">string</span> tmp_relaxType, relaxType;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;atomic relaxations&quot;</span>, tmp_relaxType);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;            relaxType = tmp_relaxType;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        }</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            relaxType = <span class="stringliteral">&quot;eadl&quot;</span>;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        }</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;ensdf&quot;</span>)) {</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            relaxType = <span class="stringliteral">&quot;ensdf&quot;</span>;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Fluorescence and auger from the ensdf file will be used.\n&quot;</span>);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        }</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;eadl&quot;</span>)) {</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            relaxType = <span class="stringliteral">&quot;eadl&quot;</span>;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Fluorescence and auger from the ensdf file will be ignored. EADL relaxations will be used.\n&quot;</span>);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;none&quot;</span>) || inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;off&quot;</span>) || inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(relaxType,<span class="stringliteral">&quot;no&quot;</span>)) {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            relaxType = <span class="stringliteral">&quot;off&quot;</span>;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Fluorescence and auger from the ensdf file will be ignored. No relaxations following radionuclide disintegrations will be modelled.\n&quot;</span>);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        }</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Error: Invalid selection for &#39;atomic relaxations&#39;. Use &#39;eadl&#39; (default), &#39;ensdf&#39; or &#39;off&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        }</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        <span class="comment">// Determine whether to output beta energy spectra to files</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        <span class="comment">// (options: yes or no)</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <span class="keywordtype">string</span> tmp_outputBetaSpectra, outputBetaSpectra;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;output beta spectra&quot;</span>, tmp_outputBetaSpectra);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            outputBetaSpectra = tmp_outputBetaSpectra;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(outputBetaSpectra,<span class="stringliteral">&quot;yes&quot;</span>)) {</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Beta energy spectra will be output to files.\n&quot;</span>);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            }</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(outputBetaSpectra,<span class="stringliteral">&quot;no&quot;</span>)) {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Beta energy spectra will not be output to files.\n&quot;</span>);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Error: Invalid selection for &#39;output beta spectra&#39;. Use &#39;no&#39; (default) or &#39;yes&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            }</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            outputBetaSpectra = <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        <span class="comment">// Determine whether to score alpha energy locally or discard it</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        <span class="comment">// By default, the energy is discarded</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        <span class="keywordtype">string</span> tmp_alphaScoring;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        <span class="keywordtype">bool</span> scoreAlphasLocally = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;alpha scoring&quot;</span>, tmp_alphaScoring);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(tmp_alphaScoring,<span class="stringliteral">&quot;local&quot;</span>)) {</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                scoreAlphasLocally = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Alpha particles will deposit energy locally, in the same region as creation.\n&quot;</span>);</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;            }</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(tmp_alphaScoring,<span class="stringliteral">&quot;discard&quot;</span>)) {</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                scoreAlphasLocally = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Alpha particles will be discarded (no transport or energy deposition).\n&quot;</span>);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Error: Invalid selection for &#39;alpha scoring&#39;. Use &#39;discard&#39; (default) or &#39;local&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;            }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        }</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        <span class="comment">// Determine whether to score alpha energy locally or discard it</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        <span class="comment">// By default, the energy is discarded</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        <span class="keywordtype">string</span> tmp_allowMultiTransition;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        <span class="keywordtype">bool</span> allowMultiTransition = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;extra transition approximation&quot;</span>, tmp_allowMultiTransition);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        <span class="keywordflow">if</span> (!err) {</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(tmp_allowMultiTransition,<span class="stringliteral">&quot;on&quot;</span>)) {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                allowMultiTransition = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Extra transition approximation is on. If the intensity away from a level in a radionuclide daughter is larger than the intensity feeding the level (e.g. decays to that level), then additional transitions away from that level will be sampled. They will not be correlated with decays, but the spectrum will produce emission rates to match both the decay intensities and the internal transition intensities from the ensdf file.\n&quot;</span>);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            }</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inp-&gt;<a class="code" href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">compare</a>(tmp_allowMultiTransition,<span class="stringliteral">&quot;off&quot;</span>)) {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                allowMultiTransition = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                <a class="code" href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Extra transition approximation is off.\n&quot;</span>);</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: Error: Invalid selection for &#39;extra transition approximation&#39;. Use &#39;off&#39; (default) or &#39;on&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        }</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        <span class="comment">// For ensdf input, first check for the input argument</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        <span class="keywordtype">string</span> ensdf_file;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        err = inp-&gt;<a class="code" href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">getInput</a>(<span class="stringliteral">&quot;ensdf file&quot;</span>,ensdf_file);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        <span class="comment">// If not passed as input, find the ensdf file in the</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        <span class="comment">// directory $HEN_HOUSE/spectra/lnhb/ensdf/</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;            <a class="code" href="classEGS__Application.html">EGS_Application</a> *app = <a class="code" href="classEGS__Application.html#a0bacaf36aa14a5851c5dd6f8efd679ee">EGS_Application::activeApplication</a>();</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;            <span class="keywordflow">if</span> (app) {</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(app-&gt;<a class="code" href="classEGS__Application.html#a2cdaedca895295cc22e9e888dcf0712c">getHenHouse</a>(),<span class="stringliteral">&quot;spectra&quot;</span>);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),<span class="stringliteral">&quot;lnhb&quot;</span>);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),<span class="stringliteral">&quot;ensdf&quot;</span>);</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            }</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                <span class="keywordtype">char</span> *hen_house = getenv(<span class="stringliteral">&quot;HEN_HOUSE&quot;</span>);</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                <span class="keywordflow">if</span> (!hen_house) {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                    <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: &quot;</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                               <span class="stringliteral">&quot;No active application and HEN_HOUSE not defined.\n&quot;</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                               <span class="stringliteral">&quot;Assuming local directory for spectra\n&quot;</span>);</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                    ensdf_file = <span class="stringliteral">&quot;./&quot;</span>;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                    ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(hen_house,<span class="stringliteral">&quot;spectra&quot;</span>);</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                    ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),<span class="stringliteral">&quot;lnhb&quot;</span>);</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                    ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),<span class="stringliteral">&quot;ensdf&quot;</span>);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                }</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            ensdf_file = <a class="code" href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a>(ensdf_file.c_str(),nuclide.append(<span class="stringliteral">&quot;.txt&quot;</span>));</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        }</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        <span class="comment">// Check that the ensdf file exists</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        ifstream ensdf_fh;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        ensdf_fh.open(ensdf_file.c_str(),ios::in);</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        <span class="keywordflow">if</span> (!ensdf_fh.is_open()) {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;EGS_BaseSpectrum::createSpectrum: failed to open ensdf file %s&quot;</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                       <span class="stringliteral">&quot; for reading\n&quot;</span>,ensdf_file.c_str());</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        ensdf_fh.close();</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        <span class="comment">// Create the spectrum</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        spec = <span class="keyword">new</span> <a class="code" href="classEGS__RadionuclideSpectrum.html">EGS_RadionuclideSpectrum</a>(nuclide, ensdf_file, relativeActivity, relaxType, outputBetaSpectra, scoreAlphasLocally, allowMultiTransition);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    }</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        <a class="code" href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a>(<span class="stringliteral">&quot;%s unknown spectrum type %s\n&quot;</span>,spec_msg1,stype.c_str());</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    }</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">if</span> (delete_it) {</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <span class="keyword">delete</span> inp;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    }</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="keywordflow">return</span> spec;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;}</div>
<div class="ttc" id="classEGS__UniformSpectrum_html_ae37406269047422369408d6813427ead"><div class="ttname"><a href="classEGS__UniformSpectrum.html#ae37406269047422369408d6813427ead">EGS_UniformSpectrum::EGS_UniformSpectrum</a></div><div class="ttdeci">EGS_UniformSpectrum(EGS_Float emin, EGS_Float emax)</div><div class="ttdoc">Construct a uniform spectrum between emin and emax. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00306">egs_spectra.cpp:306</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html">EGS_RadionuclideSpectrum</a></div><div class="ttdoc">A radionuclide spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01018">egs_spectra.cpp:1018</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_a20a72c6a9cde8246cbdfe42e23df362d"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#a20a72c6a9cde8246cbdfe42e23df362d">EGS_RadionuclideSpectrum::~EGS_RadionuclideSpectrum</a></div><div class="ttdeci">~EGS_RadionuclideSpectrum()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01124">egs_spectra.cpp:1124</a></div></div>
<div class="ttc" id="egs__libconfig_8h_html_ad29043faadac119821ed848d412e2c00"><div class="ttname"><a href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00">EGS_EXPORT</a></div><div class="ttdeci">#define EGS_EXPORT</div><div class="ttdoc">Export symbols from the egspp library. </div><div class="ttdef"><b>Definition:</b> <a href="egs__libconfig_8h_source.html#l00090">egs_libconfig.h:90</a></div></div>
<div class="ttc" id="group__egspp__main_html_gabcfd5e49b56f8b98998f903c4328ef59"><div class="ttname"><a href="group__egspp__main.html#gabcfd5e49b56f8b98998f903c4328ef59">loopMax</a></div><div class="ttdeci">const EGS_I64 loopMax</div><div class="ttdoc">The maximum number of iterations for near-infinite loops. </div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8h_source.html#l00095">egs_functions.h:95</a></div></div>
<div class="ttc" id="group__egspp__main_html_ga70ad7f086f097e38f94a573f49a4dd1f"><div class="ttname"><a href="group__egspp__main.html#ga70ad7f086f097e38f94a573f49a4dd1f">egsGetI64</a></div><div class="ttdeci">bool EGS_EXPORT egsGetI64(istream &amp;data, EGS_I64 &amp;n)</div><div class="ttdoc">Reads a 64 bit integer from the stream data and assigns it to n. Returns true on success, false on failure. </div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00068">egs_functions.cpp:68</a></div></div>
<div class="ttc" id="classEGS__UniformSpectrum_html_a3937d64b5889e738a3383569b9f015d9"><div class="ttname"><a href="classEGS__UniformSpectrum.html#a3937d64b5889e738a3383569b9f015d9">EGS_UniformSpectrum::de</a></div><div class="ttdeci">EGS_Float de</div><div class="ttdoc">Emax - Emin. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00328">egs_spectra.cpp:328</a></div></div>
<div class="ttc" id="egs__alias__table_8h_html"><div class="ttname"><a href="egs__alias__table_8h.html">egs_alias_table.h</a></div><div class="ttdoc">EGS_AliasTable class header file. </div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_af296f62f4a5e6650c086f350650e9d33"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#af296f62f4a5e6650c086f350650e9d33">EGS_RadionuclideSpectrum::setSpectrumWeight</a></div><div class="ttdeci">void setSpectrumWeight(EGS_Float newWeight)</div><div class="ttdoc">Set the relative weight assigned to this spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01170">egs_spectra.cpp:1170</a></div></div>
<div class="ttc" id="classEGS__AliasTable_html"><div class="ttname"><a href="classEGS__AliasTable.html">EGS_AliasTable</a></div><div class="ttdoc">A class for sampling random values from a given probability distribution using the alias table techni...</div><div class="ttdef"><b>Definition:</b> <a href="egs__alias__table_8h_source.html#l00063">egs_alias_table.h:63</a></div></div>
<div class="ttc" id="egs__base__source_8h_html"><div class="ttname"><a href="egs__base__source_8h.html">egs_base_source.h</a></div><div class="ttdoc">EGS_BaseSource class header file. </div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_a09881c2d4c9b7b38df54db8c3eff23ca"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#a09881c2d4c9b7b38df54db8c3eff23ca">EGS_RadionuclideSpectrum::expectedAverage</a></div><div class="ttdeci">EGS_Float expectedAverage() const </div><div class="ttdoc">Not implemented - returns 0. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01673">egs_spectra.cpp:1673</a></div></div>
<div class="ttc" id="classEGS__Input_html_a4941448779de7f5f6742c7dde00e12c3"><div class="ttname"><a href="classEGS__Input.html#a4941448779de7f5f6742c7dde00e12c3">EGS_Input::isA</a></div><div class="ttdeci">bool isA(const string &amp;key) const </div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8cpp_source.html#l00278">egs_input.cpp:278</a></div></div>
<div class="ttc" id="classEGS__BaseSpectrum_html_a0b06e8749abff71c0112a37bbf2b1371"><div class="ttname"><a href="classEGS__BaseSpectrum.html#a0b06e8749abff71c0112a37bbf2b1371">EGS_BaseSpectrum::reportAverageEnergy</a></div><div class="ttdeci">void reportAverageEnergy() const </div><div class="ttdoc">Report the average energy (expected and actually sampled). </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00064">egs_spectra.cpp:64</a></div></div>
<div class="ttc" id="classEGS__TabulatedSpectrum_html_ab0e988a46cdc3730a4086c273c917e9e"><div class="ttname"><a href="classEGS__TabulatedSpectrum.html#ab0e988a46cdc3730a4086c273c917e9e">EGS_TabulatedSpectrum::EGS_TabulatedSpectrum</a></div><div class="ttdeci">EGS_TabulatedSpectrum(int N, const EGS_Float *x, const EGS_Float *f, int Type=1, const char *fname=0)</div><div class="ttdoc">Construct a tabulated spectrum from the energies x and the probabilities f. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00401">egs_spectra.cpp:401</a></div></div>
<div class="ttc" id="classEGS__UniformSpectrum_html"><div class="ttname"><a href="classEGS__UniformSpectrum.html">EGS_UniformSpectrum</a></div><div class="ttdoc">A uniform energy spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00301">egs_spectra.cpp:301</a></div></div>
<div class="ttc" id="egs__input_8h_html"><div class="ttname"><a href="egs__input_8h.html">egs_input.h</a></div><div class="ttdoc">EGS_Input class header file. </div></div>
<div class="ttc" id="classEGS__MonoEnergy_html"><div class="ttname"><a href="classEGS__MonoEnergy.html">EGS_MonoEnergy</a></div><div class="ttdoc">A monoenergetic particle spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00083">egs_spectra.cpp:83</a></div></div>
<div class="ttc" id="group__egspp__main_html_ga02ff22ad01a5d7f52db6fea9c4615286"><div class="ttname"><a href="group__egspp__main.html#ga02ff22ad01a5d7f52db6fea9c4615286">egsStoreI64</a></div><div class="ttdeci">bool EGS_EXPORT egsStoreI64(ostream &amp;data, EGS_I64 n)</div><div class="ttdoc">Writes the 64 bit integer n to the output stream data and returns true on success, false on failure. </div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00057">egs_functions.cpp:57</a></div></div>
<div class="ttc" id="classEGS__DoubleGaussianSpectrum_html_a717d540073d680bf5eb5f75973c6f732"><div class="ttname"><a href="classEGS__DoubleGaussianSpectrum.html#a717d540073d680bf5eb5f75973c6f732">EGS_DoubleGaussianSpectrum::EGS_DoubleGaussianSpectrum</a></div><div class="ttdeci">EGS_DoubleGaussianSpectrum(EGS_Float mean_energy, EGS_Float sig_left, EGS_Float sig_right)</div><div class="ttdoc">Construct a double-Gaussian spectrum with mean energy mean_energy and widths sig_left and sig_right...</div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00229">egs_spectra.cpp:229</a></div></div>
<div class="ttc" id="group__egspp__main_html_gac6ca173a4a5cc865f8506000e3a21cc8"><div class="ttname"><a href="group__egspp__main.html#gac6ca173a4a5cc865f8506000e3a21cc8">egsJoinPath</a></div><div class="ttdeci">string egsJoinPath(const string &amp;first, const string &amp;second)</div><div class="ttdoc">Join two path variables (or a path and a file name) using the platform specific directory separator a...</div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00194">egs_functions.cpp:194</a></div></div>
<div class="ttc" id="classEGS__RandomGenerator_html_a1a8125374996eec60b8e017aca93c047"><div class="ttname"><a href="classEGS__RandomGenerator.html#a1a8125374996eec60b8e017aca93c047">EGS_RandomGenerator::getAzimuth</a></div><div class="ttdeci">void getAzimuth(EGS_Float &amp;cphi, EGS_Float &amp;sphi)</div><div class="ttdoc">Sets cphi and sphi to the cosine and sine of a random angle uniformely distributed between 0 and ...</div><div class="ttdef"><b>Definition:</b> <a href="egs__rndm_8h_source.html#l00138">egs_rndm.h:138</a></div></div>
<div class="ttc" id="classEGS__SimpleContainer_html"><div class="ttname"><a href="classEGS__SimpleContainer.html">EGS_SimpleContainer&lt; EGS_RelaxationParticle &gt;</a></div></div>
<div class="ttc" id="classEGS__TabulatedSpectrum_html"><div class="ttname"><a href="classEGS__TabulatedSpectrum.html">EGS_TabulatedSpectrum</a></div><div class="ttdoc">A tabulated spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00383">egs_spectra.cpp:383</a></div></div>
<div class="ttc" id="classEGS__AliasTable_html_aca48994ac0438c385e5e4b22cf977ba2"><div class="ttname"><a href="classEGS__AliasTable.html#aca48994ac0438c385e5e4b22cf977ba2">EGS_AliasTable::sample</a></div><div class="ttdeci">EGS_Float sample(EGS_RandomGenerator *rndm) const </div><div class="ttdoc">Get a random point from this table using the RNG rndm. </div><div class="ttdef"><b>Definition:</b> <a href="egs__alias__table_8cpp_source.html#l00267">egs_alias_table.cpp:267</a></div></div>
<div class="ttc" id="classEGS__GaussianSpectrum_html_a2aab18920fcbee2c8a0ccee2d06c57d9"><div class="ttname"><a href="classEGS__GaussianSpectrum.html#a2aab18920fcbee2c8a0ccee2d06c57d9">EGS_GaussianSpectrum::sigma</a></div><div class="ttdeci">EGS_Float sigma</div><div class="ttdoc">The Gaussian width. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00190">egs_spectra.cpp:190</a></div></div>
<div class="ttc" id="classEGS__GaussianSpectrum_html_a44cad9def151b6d0615a6472e9a1d8e6"><div class="ttname"><a href="classEGS__GaussianSpectrum.html#a44cad9def151b6d0615a6472e9a1d8e6">EGS_GaussianSpectrum::Emax</a></div><div class="ttdeci">EGS_Float Emax</div><div class="ttdoc">The maximum energy. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00197">egs_spectra.cpp:197</a></div></div>
<div class="ttc" id="egs__advanced__application_8h_html"><div class="ttname"><a href="egs__advanced__application_8h.html">egs_advanced_application.h</a></div><div class="ttdoc">EGS_AdvancedApplication class header file. </div></div>
<div class="ttc" id="classEGS__DoubleGaussianSpectrum_html_acfa3737583092a81f4f994941a8c6707"><div class="ttname"><a href="classEGS__DoubleGaussianSpectrum.html#acfa3737583092a81f4f994941a8c6707">EGS_DoubleGaussianSpectrum::Emax</a></div><div class="ttdeci">EGS_Float Emax</div><div class="ttdoc">The maximum energy. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00258">egs_spectra.cpp:258</a></div></div>
<div class="ttc" id="egs__ensdf_8h_html"><div class="ttname"><a href="egs__ensdf_8h.html">egs_ensdf.h</a></div><div class="ttdoc">The ensdf library header file. </div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_a777f749a1586f3739607f4b6302382fa"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#a777f749a1586f3739607f4b6302382fa">EGS_RadionuclideSpectrum::getShowerIndex</a></div><div class="ttdeci">EGS_I64 getShowerIndex() const </div><div class="ttdoc">Get the shower index of the most recent emission. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01155">egs_spectra.cpp:1155</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_abbf147294c7c2dee48918ca4c903a342"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#abbf147294c7c2dee48918ca4c903a342">EGS_RadionuclideSpectrum::getTime</a></div><div class="ttdeci">double getTime() const </div><div class="ttdoc">Get the emission time of the most recent emission. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01150">egs_spectra.cpp:1150</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_ac244e1d5382b53c70874139aaa022040"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#ac244e1d5382b53c70874139aaa022040">EGS_RadionuclideSpectrum::getEmissionType</a></div><div class="ttdeci">unsigned int getEmissionType() const </div><div class="ttdoc">Get the emission type of the most recent source particle. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01192">egs_spectra.cpp:1192</a></div></div>
<div class="ttc" id="classEGS__BaseSpectrum_html_aaf11ec2f02be812666f474537c00940e"><div class="ttname"><a href="classEGS__BaseSpectrum.html#aaf11ec2f02be812666f474537c00940e">EGS_BaseSpectrum::createSpectrum</a></div><div class="ttdeci">static EGS_BaseSpectrum * createSpectrum(EGS_Input *inp)</div><div class="ttdoc">Create and return a pointer to a spectrum object from the information pointed to by inp...</div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01740">egs_spectra.cpp:1740</a></div></div>
<div class="ttc" id="structEGS__RelaxationParticle_html_a4e52533007f3370bc9ecf20701f296d1"><div class="ttname"><a href="structEGS__RelaxationParticle.html#a4e52533007f3370bc9ecf20701f296d1">EGS_RelaxationParticle::q</a></div><div class="ttdeci">int q</div><div class="ttdoc">charge (0-photon, -1=electron) </div><div class="ttdef"><b>Definition:</b> <a href="egs__atomic__relaxations_8h_source.html#l00044">egs_atomic_relaxations.h:44</a></div></div>
<div class="ttc" id="classEGS__GaussianSpectrum_html"><div class="ttname"><a href="classEGS__GaussianSpectrum.html">EGS_GaussianSpectrum</a></div><div class="ttdoc">A Gaussian spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00142">egs_spectra.cpp:142</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_a42b252a24baabff574ea432d1c7d12f9"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#a42b252a24baabff574ea432d1c7d12f9">EGS_RadionuclideSpectrum::getSpectrumWeight</a></div><div class="ttdeci">EGS_Float getSpectrumWeight() const </div><div class="ttdoc">Get the relative weight assigned to this spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01165">egs_spectra.cpp:1165</a></div></div>
<div class="ttc" id="classEGS__RandomGenerator_html"><div class="ttname"><a href="classEGS__RandomGenerator.html">EGS_RandomGenerator</a></div><div class="ttdoc">Base random number generator class. All random number generators should be derived from this class...</div><div class="ttdef"><b>Definition:</b> <a href="egs__rndm_8h_source.html#l00067">egs_rndm.h:67</a></div></div>
<div class="ttc" id="group__egspp__main_html_ga4454fdf3403e87c098cd55f60dedbe56"><div class="ttname"><a href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56">egsFatal</a></div><div class="ttdeci">EGS_InfoFunction EGS_EXPORT egsFatal</div><div class="ttdoc">Always use this function for reporting fatal errors. </div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00136">egs_functions.cpp:136</a></div></div>
<div class="ttc" id="classEGS__Ensdf_html"><div class="ttname"><a href="classEGS__Ensdf.html">EGS_Ensdf</a></div><div class="ttdoc">The ensdf class for reading ensdf format data files. </div><div class="ttdef"><b>Definition:</b> <a href="egs__ensdf_8h_source.html#l00492">egs_ensdf.h:492</a></div></div>
<div class="ttc" id="classEGS__UniformSpectrum_html_a1baf93b8a88e784fe73b2d7167c9c822"><div class="ttname"><a href="classEGS__UniformSpectrum.html#a1baf93b8a88e784fe73b2d7167c9c822">EGS_UniformSpectrum::Emax</a></div><div class="ttdeci">EGS_Float Emax</div><div class="ttdoc">The maximum energy. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00327">egs_spectra.cpp:327</a></div></div>
<div class="ttc" id="group__egspp__main_html_ga63fd04e4564a563f2f099c3eae6426f5"><div class="ttname"><a href="group__egspp__main.html#ga63fd04e4564a563f2f099c3eae6426f5">egsExpandPath</a></div><div class="ttdeci">string egsExpandPath(const string &amp;aname)</div><div class="ttdoc">Expands first environment variable found in a file name. </div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00216">egs_functions.cpp:216</a></div></div>
<div class="ttc" id="egs__rndm_8h_html"><div class="ttname"><a href="egs__rndm_8h.html">egs_rndm.h</a></div><div class="ttdoc">EGS_RandomGenerator class header file. </div></div>
<div class="ttc" id="group__egspp__main_html_ga38c38ac950788399c630481c2b3722f2"><div class="ttname"><a href="group__egspp__main.html#ga38c38ac950788399c630481c2b3722f2">egsInformation</a></div><div class="ttdeci">EGS_InfoFunction EGS_EXPORT egsInformation</div><div class="ttdoc">Always use this function for reporting the progress of a simulation and any other type of information...</div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00134">egs_functions.cpp:134</a></div></div>
<div class="ttc" id="classLevelRecord_html"><div class="ttname"><a href="classLevelRecord.html">LevelRecord</a></div><div class="ttdef"><b>Definition:</b> <a href="egs__ensdf_8h_source.html#l00243">egs_ensdf.h:243</a></div></div>
<div class="ttc" id="classEGS__DoubleGaussianSpectrum_html_a0d2cf16c2766f06f2ff58a1e0d4e019f"><div class="ttname"><a href="classEGS__DoubleGaussianSpectrum.html#a0d2cf16c2766f06f2ff58a1e0d4e019f">EGS_DoubleGaussianSpectrum::p</a></div><div class="ttdeci">EGS_Float p</div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00261">egs_spectra.cpp:261</a></div></div>
<div class="ttc" id="classEGS__Application_html_a0bacaf36aa14a5851c5dd6f8efd679ee"><div class="ttname"><a href="classEGS__Application.html#a0bacaf36aa14a5851c5dd6f8efd679ee">EGS_Application::activeApplication</a></div><div class="ttdeci">static EGS_Application * activeApplication()</div><div class="ttdoc">Get the active application. </div><div class="ttdef"><b>Definition:</b> <a href="egs__application_8cpp_source.html#l00103">egs_application.cpp:103</a></div></div>
<div class="ttc" id="egs__math_8h_html"><div class="ttname"><a href="egs__math_8h.html">egs_math.h</a></div><div class="ttdoc">Attempts to fix broken math header files. </div></div>
<div class="ttc" id="structEGS__RelaxationParticle_html_a9db6f3ddb4a3dbf06fa5e513fd274f8c"><div class="ttname"><a href="structEGS__RelaxationParticle.html#a9db6f3ddb4a3dbf06fa5e513fd274f8c">EGS_RelaxationParticle::E</a></div><div class="ttdeci">EGS_Float E</div><div class="ttdoc">energy in MeV </div><div class="ttdef"><b>Definition:</b> <a href="egs__atomic__relaxations_8h_source.html#l00045">egs_atomic_relaxations.h:45</a></div></div>
<div class="ttc" id="classEGS__RandomGenerator_html_abad39a80b392acb3ab7935db0bd94b79"><div class="ttname"><a href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79">EGS_RandomGenerator::getUniform</a></div><div class="ttdeci">EGS_Float getUniform()</div><div class="ttdoc">Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive). </div><div class="ttdef"><b>Definition:</b> <a href="egs__rndm_8h_source.html#l00103">egs_rndm.h:103</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_a4bc1f56cb628f18a6c9af794a7649d26"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#a4bc1f56cb628f18a6c9af794a7649d26">EGS_RadionuclideSpectrum::printSampledEmissions</a></div><div class="ttdeci">void printSampledEmissions()</div><div class="ttdoc">Print the sampled emission intensities. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01198">egs_spectra.cpp:1198</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_a6c358434a6c7aa0e94d1cf6707dc85af"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#a6c358434a6c7aa0e94d1cf6707dc85af">EGS_RadionuclideSpectrum::EGS_RadionuclideSpectrum</a></div><div class="ttdeci">EGS_RadionuclideSpectrum(const string nuclide, const string ensdf_file, const EGS_Float relativeActivity, const string relaxType, const string outputBetaSpectra, const bool scoreAlphasLocally, const bool allowMultiTransition)</div><div class="ttdoc">Construct a radionuclide spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01024">egs_spectra.cpp:1024</a></div></div>
<div class="ttc" id="group__egspp__main_html_gac5a51c4d1a2d49ad111b65c848f45719"><div class="ttname"><a href="group__egspp__main.html#gac5a51c4d1a2d49ad111b65c848f45719">epsilon</a></div><div class="ttdeci">const EGS_Float epsilon</div><div class="ttdoc">The epsilon constant for floating point comparisons. </div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8h_source.html#l00061">egs_functions.h:61</a></div></div>
<div class="ttc" id="classEGS__DoubleGaussianSpectrum_html_a3cbe1241001e367eedc12de9185d6fdc"><div class="ttname"><a href="classEGS__DoubleGaussianSpectrum.html#a3cbe1241001e367eedc12de9185d6fdc">EGS_DoubleGaussianSpectrum::sright</a></div><div class="ttdeci">EGS_Float sright</div><div class="ttdoc">The width of the spectrum right of Eo. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00260">egs_spectra.cpp:260</a></div></div>
<div class="ttc" id="classEGS__Application_html_a2cdaedca895295cc22e9e888dcf0712c"><div class="ttname"><a href="classEGS__Application.html#a2cdaedca895295cc22e9e888dcf0712c">EGS_Application::getHenHouse</a></div><div class="ttdeci">const string &amp; getHenHouse() const </div><div class="ttdoc">Returns the HEN_HOUSE directory. </div><div class="ttdef"><b>Definition:</b> <a href="egs__application_8h_source.html#l00493">egs_application.h:493</a></div></div>
<div class="ttc" id="classEGS__RadionuclideBetaSpectrum_html_a56ceecb0bb2f098cd80f4c60f3f67d2d"><div class="ttname"><a href="classEGS__RadionuclideBetaSpectrum.html#a56ceecb0bb2f098cd80f4c60f3f67d2d">EGS_RadionuclideBetaSpectrum::EGS_RadionuclideBetaSpectrum</a></div><div class="ttdeci">EGS_RadionuclideBetaSpectrum(EGS_Ensdf *decays, const string outputBetaSpectra)</div><div class="ttdoc">Construct beta spectra for a radionuclide. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00461">egs_spectra.cpp:461</a></div></div>
<div class="ttc" id="classEGS__DoubleGaussianSpectrum_html"><div class="ttname"><a href="classEGS__DoubleGaussianSpectrum.html">EGS_DoubleGaussianSpectrum</a></div><div class="ttdoc">A double-Gaussian spectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00222">egs_spectra.cpp:222</a></div></div>
<div class="ttc" id="classEGS__DoubleGaussianSpectrum_html_aec3ac6bdc71cb1610c0fdf1a9ee1bd59"><div class="ttname"><a href="classEGS__DoubleGaussianSpectrum.html#aec3ac6bdc71cb1610c0fdf1a9ee1bd59">EGS_DoubleGaussianSpectrum::sleft</a></div><div class="ttdeci">EGS_Float sleft</div><div class="ttdoc">The width of the spectrum left of Eo. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00259">egs_spectra.cpp:259</a></div></div>
<div class="ttc" id="classEGS__Input_html"><div class="ttname"><a href="classEGS__Input.html">EGS_Input</a></div><div class="ttdoc">A class for storing information in a tree-like structure of key-value pairs. This class is used throu...</div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8h_source.html#l00182">egs_input.h:182</a></div></div>
<div class="ttc" id="classEGS__Input_html_a9b100c2fe8de2f22befea1e10a46466c"><div class="ttname"><a href="classEGS__Input.html#a9b100c2fe8de2f22befea1e10a46466c">EGS_Input::compare</a></div><div class="ttdeci">static bool compare(const string &amp;s1, const string &amp;s2)</div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8cpp_source.html#l01170">egs_input.cpp:1170</a></div></div>
<div class="ttc" id="classEGS__BaseSpectrum_html"><div class="ttname"><a href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a></div><div class="ttdoc">Base class for energy spectra. All energy spectra in the EGSnrc C++ class library are derived from th...</div><div class="ttdef"><b>Definition:</b> <a href="egs__base__source_8h_source.html#l00334">egs_base_source.h:334</a></div></div>
<div class="ttc" id="classEGS__RadionuclideBetaSpectrum_html"><div class="ttname"><a href="classEGS__RadionuclideBetaSpectrum.html">EGS_RadionuclideBetaSpectrum</a></div><div class="ttdoc">Beta spectrum generation for EGS_RadionuclideSpectrum. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00456">egs_spectra.cpp:456</a></div></div>
<div class="ttc" id="structEGS__RelaxationParticle_html"><div class="ttname"><a href="structEGS__RelaxationParticle.html">EGS_RelaxationParticle</a></div><div class="ttdef"><b>Definition:</b> <a href="egs__atomic__relaxations_8h_source.html#l00043">egs_atomic_relaxations.h:43</a></div></div>
<div class="ttc" id="classEGS__MonoEnergy_html_ad998d3830ea0f8e60589480390bae6be"><div class="ttname"><a href="classEGS__MonoEnergy.html#ad998d3830ea0f8e60589480390bae6be">EGS_MonoEnergy::EGS_MonoEnergy</a></div><div class="ttdeci">EGS_MonoEnergy(EGS_Float energy)</div><div class="ttdoc">Construct a monoenergetic spectrum with energy energy. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00088">egs_spectra.cpp:88</a></div></div>
<div class="ttc" id="classEGS__GaussianSpectrum_html_a1c14cc1c54fb21b6e8d780bfaf284a9d"><div class="ttname"><a href="classEGS__GaussianSpectrum.html#a1c14cc1c54fb21b6e8d780bfaf284a9d">EGS_GaussianSpectrum::EGS_GaussianSpectrum</a></div><div class="ttdeci">EGS_GaussianSpectrum(EGS_Float mean_energy, EGS_Float Sigma)</div><div class="ttdoc">Construct a Gaussian spectrum with mean energy mean_energy and width Sigma. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l00152">egs_spectra.cpp:152</a></div></div>
<div class="ttc" id="classEGS__Input_html_a1fb7e11391a1ab33c23321633d035781"><div class="ttname"><a href="classEGS__Input.html#a1fb7e11391a1ab33c23321633d035781">EGS_Input::takeInputItem</a></div><div class="ttdeci">EGS_Input * takeInputItem(const string &amp;key, bool self=true)</div><div class="ttdoc">Get the property named key. </div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8cpp_source.html#l00226">egs_input.cpp:226</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_ad425995e7a729d5f83c8af0f9920e221"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#ad425995e7a729d5f83c8af0f9920e221">EGS_RadionuclideSpectrum::getEdep</a></div><div class="ttdeci">EGS_Float getEdep() const </div><div class="ttdoc">Get energy that should be deposited locally from relaxations/alphas. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01160">egs_spectra.cpp:1160</a></div></div>
<div class="ttc" id="egs__application_8h_html"><div class="ttname"><a href="egs__application_8h.html">egs_application.h</a></div><div class="ttdoc">EGS_Application class header file. </div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_aa385c4146f0c49f6eff460434e383e75"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#aa385c4146f0c49f6eff460434e383e75">EGS_RadionuclideSpectrum::maxEnergy</a></div><div class="ttdeci">EGS_Float maxEnergy() const </div><div class="ttdoc">Returns the maximum energy that may be emitted. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01140">egs_spectra.cpp:1140</a></div></div>
<div class="ttc" id="classEGS__Input_html_a154f3de14ebb23c3e78316b40b33b719"><div class="ttname"><a href="classEGS__Input.html#a154f3de14ebb23c3e78316b40b33b719">EGS_Input::getInput</a></div><div class="ttdeci">int getInput(const string &amp;key, vector&lt; string &gt; &amp;values) const </div><div class="ttdoc">Assign values to an array of strings from an input identified by key. </div><div class="ttdef"><b>Definition:</b> <a href="egs__input_8cpp_source.html#l00338">egs_input.cpp:338</a></div></div>
<div class="ttc" id="classEGS__Application_html"><div class="ttname"><a href="classEGS__Application.html">EGS_Application</a></div><div class="ttdoc">Base class for advanced EGSnrc C++ applications. </div><div class="ttdef"><b>Definition:</b> <a href="egs__application_8h_source.html#l00267">egs_application.h:267</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_abb64c6df6ae518d3a7cf75166f2ed94c"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#abb64c6df6ae518d3a7cf75166f2ed94c">EGS_RadionuclideSpectrum::sample</a></div><div class="ttdeci">EGS_Float sample(EGS_RandomGenerator *rndm)</div><div class="ttdoc">Sample an event from the spectrum, returns the energy of the emitted particle. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01296">egs_spectra.cpp:1296</a></div></div>
<div class="ttc" id="classEGS__RadionuclideSpectrum_html_ac77881fe4dfefa8c5b73697e974bfb24"><div class="ttname"><a href="classEGS__RadionuclideSpectrum.html#ac77881fe4dfefa8c5b73697e974bfb24">EGS_RadionuclideSpectrum::getCharge</a></div><div class="ttdeci">int getCharge() const </div><div class="ttdoc">Get the charge of the most recent emission. </div><div class="ttdef"><b>Definition:</b> <a href="egs__spectra_8cpp_source.html#l01145">egs_spectra.cpp:1145</a></div></div>
<div class="ttc" id="group__egspp__main_html_gadf4109d942f372e48e1dea86c0ca62cb"><div class="ttname"><a href="group__egspp__main.html#gadf4109d942f372e48e1dea86c0ca62cb">egsWarning</a></div><div class="ttdeci">EGS_InfoFunction EGS_EXPORT egsWarning</div><div class="ttdoc">Always use this function for reporting warnings. </div><div class="ttdef"><b>Definition:</b> <a href="egs__functions_8cpp_source.html#l00135">egs_functions.cpp:135</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
